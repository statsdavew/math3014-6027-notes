<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>MATH3014-6027: Exercises 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="math3014-6027_exercises-1_files/libs/clipboard/clipboard.min.js"></script>
<script src="math3014-6027_exercises-1_files/libs/quarto-html/quarto.js"></script>
<script src="math3014-6027_exercises-1_files/libs/quarto-html/popper.min.js"></script>
<script src="math3014-6027_exercises-1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="math3014-6027_exercises-1_files/libs/quarto-html/anchor.min.js"></script>
<link href="math3014-6027_exercises-1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="math3014-6027_exercises-1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="math3014-6027_exercises-1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="math3014-6027_exercises-1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="math3014-6027_exercises-1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">MATH3014-6027: Exercises 1</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<ol type="1">
<li><p><span class="citation" data-cites="Morris2011">(Adapted from <a href="#ref-Morris2011" role="doc-biblioref">Morris, 2011</a>)</span> A classic and famous example of a simple hypothetical experiment was described by <span class="citation" data-cites="Fisher1935">Fisher (<a href="#ref-Fisher1935" role="doc-biblioref">1935</a>)</span>:</p>
<blockquote class="blockquote">
<p>A lady declares that by tasting a cup of tea made with milk she can discriminate whether the milk or the tea infusion was added first to the cup. We will consider the problem of designing an experiment by means of which this assertion can be tested. For this purpose let us first lay down a simple form of experiment with a view to studying its limitations and its characteristics, both those that same essential to the experimental method, when well developed, and those that are not essential but auxiliary.</p>
<p>Our experiment consists in mixing eight cups of tea, four in one way and four in the other, and presenting them to the subject for judgement in a random order. The subject has been told in advance of what the test will consist, namely that she will be asked to taste eight cups, that these shall be four of each kind, and that they shall be presented to her in a random order, that is an order not determined arbitrarily by human choice, but by the actual manipulation of the physical appartatus used in games of chance, cards, dice, roulettes, etc., or, more expeditiously, from a published collection of random sampling numbers purporting to give the actual results of such manipulation<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. Her task is to divide the 8 cups into two sets of 4, agreeing, if possible, with the treatments received.</p>
</blockquote>
<ol type="a">
<li>Define the treatments in this experiment.</li>
<li>Identify the units in this experiment.</li>
<li>How might a “physical appartatus” from a “game of chance” be used to perform the randomisation? Explain one example.</li>
<li>Suppose eight tea cups are available for this experiment but they are not identical. Instead they come from two sets. Four are made from heavy, thick porcelain; four from much lighter china. If each cup can only be used once, how might this fact be incorporated into the design of the experiment?</li>
</ol></li>
</ol>
<details>
<summary>
<b>Solution</b>
</summary>
<ol type="a">
<li><p>There are two treatments in the experiment - the two ingredients “milk first” and “tea first”.</p></li>
<li><p>The experimental units are the “cups of tea”, made up from the tea and milk used and also the cup itself.</p></li>
<li><p>The simplest method here might be to select four black playing cards and four red playing cards, assign one treatment to each colour, shuffle the cards, and then draw them in order. The colour drawn indicates the treatment that should be used to make the next cup of tea. This operation would give one possible randomisation.</p>
<p>We could of course also use <code>R</code>.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Milk first"</span>, <span class="st">"Tea first"</span>), <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>)), <span class="at">size =</span> <span class="dv">8</span>, <span class="at">replace =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Tea first"  "Milk first" "Tea first"  "Tea first"  "Milk first"
[6] "Milk first" "Milk first" "Tea first" </code></pre>
</div>
</div>
<ol start="4" type="a">
<li>Type of cup could be considered as a blocking factor. One way of incorporating it would be to split the experiment into two (blocks), each with four cups (two milk first, two tea first). We would still wish to randomise allocation of treatments to units within blocks.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>    <span class="co"># block 1</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Milk first"</span>, <span class="st">"Tea first"</span>), <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">replace =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Milk first" "Tea first"  "Milk first" "Tea first" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>    <span class="co"># block 2</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Milk first"</span>, <span class="st">"Tea first"</span>), <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">replace =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Tea first"  "Milk first" "Tea first"  "Milk first"</code></pre>
</div>
</div>
</details>
<ol start="2" type="1">
<li><p>Consider the linear model</p>
<p><span class="math display">\[\boldsymbol{y}= X\boldsymbol{\beta}+ \boldsymbol{\varepsilon}\,,\]</span> with <span class="math inline">\(\boldsymbol{y}\)</span> an <span class="math inline">\(n\times 1\)</span> vector of responses, <span class="math inline">\(X\)</span> a <span class="math inline">\(n\times p\)</span> model matrix and <span class="math inline">\(\boldsymbol{\varepsilon}\)</span> a <span class="math inline">\(n\times 1\)</span> vector of independent and identically distributed random variables with constant variance <span class="math inline">\(\sigma^2\)</span>.</p>
<ol type="a">
<li>Derive the least squares estimator <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> for this multiple linear regression model, and show that this estimator is unbiased. Using the definition of (co)variance, show that</li>
</ol>
<p><span class="math display">\[\mbox{Var}(\hat{\boldsymbol{\beta}}) = \left(X^{\mathrm{T}}X\right)^{-1}\sigma^2\,.\]</span></p>
<ol start="2" type="a">
<li>If <span class="math inline">\(\boldsymbol{\varepsilon}\sim N (\boldsymbol{0},I_n\sigma^2)\)</span>, with <span class="math inline">\(I_n\)</span> being the <span class="math inline">\(n\times n\)</span> identity matrix, show that the maximum likelihood estimators for <span class="math inline">\(\boldsymbol{\beta}\)</span> coincide with the least squares estimators.</li>
</ol></li>
</ol>
<details>
<summary>
<b>Solution</b>
</summary>
<ol type="a">
<li><p>The method of least squares minimises the sum of squared differences between the responses and the expected values, that is, minimises the expression</p>
<p><span class="math display">\[
(\boldsymbol{y}-X\boldsymbol{\beta})^{\mathrm{T}}(\boldsymbol{y}-X\boldsymbol{\beta}) = \boldsymbol{y}^{\mathrm{T}}\boldsymbol{y}- 2\boldsymbol{\beta}^{\mathrm{T}}X^{\mathrm{T}}\boldsymbol{y}+ \boldsymbol{\beta}^{\mathrm{T}}X^{\mathrm{T}}X\boldsymbol{\beta}\,.
\]</span> Differentiating with respect to the vector <span class="math inline">\(\boldsymbol{\beta}\)</span>, we obtain</p>
<p><span class="math display">\[
\frac{\partial}{\partial\boldsymbol{\beta}} = -2X^{\mathrm{T}}\boldsymbol{y}+ 2X^{\mathrm{T}}X\boldsymbol{\beta}\,.
\]</span></p>
<p>Set equal to <span class="math inline">\(\boldsymbol{0}\)</span> and solve:</p>
<p><span class="math display">\[
X^{\mathrm{T}}X\hat{\boldsymbol{\beta}} = X^{\mathrm{T}}\boldsymbol{y}\Rightarrow \hat{\boldsymbol{\beta}} = \left(X^{\mathrm{T}}X\right)^{-1}X^{\mathrm{T}}\boldsymbol{y}\,.
\]</span></p>
<p>The estimator <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> is unbiased:</p>
<p><span class="math display">\[
E(\hat{\boldsymbol{\beta}}) = \left(X^{\mathrm{T}}X\right)^{-1}X^{\mathrm{T}}E(\boldsymbol{y}) = \left(X^{\mathrm{T}}X\right)^{-1}X^{\mathrm{T}}X\boldsymbol{\beta}= \boldsymbol{\beta}\,,
\]</span></p>
<p>and has variance:</p>
<p><span class="math display">\[\begin{align*}
\mbox{Var}(\hat{\boldsymbol{\beta}}) &amp; =E\left\{ \left[\hat{\boldsymbol{\beta}} - E(\hat{\boldsymbol{\beta}})\right] \left[\hat{\boldsymbol{\beta}} - E(\hat{\boldsymbol{\beta}})\right]^{\mathrm{T}} \right\}\\
&amp; =  E\left\{ \left[\hat{\boldsymbol{\beta}} - \boldsymbol{\beta}\right] \left[\hat{\boldsymbol{\beta}} - \boldsymbol{\beta}\right]^{\mathrm{T}} \right\}\\
&amp; = E\left\{ \hat{\boldsymbol{\beta}}\hat{\boldsymbol{\beta}}^{\mathrm{T}} - 2\boldsymbol{\beta}\hat{\boldsymbol{\beta}}^{\mathrm{T}} + \boldsymbol{\beta}\boldsymbol{\beta}^{\mathrm{T}} \right\}\\
&amp; = E\left\{ \left(X^{\mathrm{T}}X\right)^{-1}X^{\mathrm{T}}\boldsymbol{y}\boldsymbol{y}^{\mathrm{T}}X\left(X^{\mathrm{T}}X\right)^{-1}  - 2\boldsymbol{\beta}\boldsymbol{y}^{\mathrm{T}}X\left(X^{\mathrm{T}}X\right)^{-1} + \boldsymbol{\beta}\boldsymbol{\beta}^{\mathrm{T}}\right\}\\
&amp; = \left(X^{\mathrm{T}}X\right)^{-1}X^{\mathrm{T}}E(\boldsymbol{y}\boldsymbol{y}^{\mathrm{T}})X\left(X^{\mathrm{T}}X\right)^{-1} - 2\boldsymbol{\beta}E(\boldsymbol{y}^{\mathrm{T}})X\left(X^{\mathrm{T}}X\right)^{-1} + \boldsymbol{\beta}\boldsymbol{\beta}^{\mathrm{T}}\\
&amp; = \left(X^{\mathrm{T}}X\right)^{-1}X^{\mathrm{T}}\left[\mbox{Var}(\boldsymbol{y}) + E(\boldsymbol{y})E(\boldsymbol{y}^{\mathrm{T}})\right]X\left(X^{\mathrm{T}}X\right)^{-1} - 2\boldsymbol{\beta}\boldsymbol{\beta}^{\mathrm{T}}X^{\mathrm{T}}X\left(X^{\mathrm{T}}X\right)^{-1} + \boldsymbol{\beta}\boldsymbol{\beta}^{\mathrm{T}}\\
&amp; = \left(X^{\mathrm{T}}X\right)^{-1}X^{\mathrm{T}}\left[I_N\sigma^2 + X\boldsymbol{\beta}\boldsymbol{\beta}^{\mathrm{T}}X^{\mathrm{T}}\right]X\left(X^{\mathrm{T}}X\right)^{-1} - \boldsymbol{\beta}\boldsymbol{\beta}^{\mathrm{T}}\\
&amp; = \left(X^{\mathrm{T}}X\right)^{-1}\sigma^2\,.
\end{align*}\]</span></p></li>
<li><p>As <span class="math inline">\(\boldsymbol{y}\sim N\left(X\boldsymbol{\beta}, I_N\sigma^2\right)\)</span>, the likelihood is given by</p>
<p><span class="math display">\[
L(\boldsymbol{\beta}\,; \boldsymbol{y}) = \left(2\pi\sigma^2\right)^{-N/2}\exp\left\{-\frac{1}{2\sigma^2}(\boldsymbol{y}- X\boldsymbol{\beta})^{\mathrm{T}}(\boldsymbol{y}- X\boldsymbol{\beta})\right\}\,.
\]</span></p>
<p>The log-likelihood is given by</p>
<p><span class="math display">\[
l(\boldsymbol{\beta}\,;\boldsymbol{y}) = -\frac{1}{2\sigma^2}(\boldsymbol{y}- X\boldsymbol{\beta})^{\mathrm{T}}(\boldsymbol{y}- X\boldsymbol{\beta}) + \mbox{constant}\,.
\]</span></p>
<p>Up to a constant, this expression is <span class="math inline">\(-1\times\)</span> the least squares equations; hence maximising the log-likelihood is equivalent to minimising the least squares equation.</p></li>
</ol>
</details>
<ol start="3" type="1">
<li><p>Consider the two nested linear models</p>
<ol type="i">
<li><p><span class="math inline">\(Y_j = \beta_0 + \beta_1x_{1j} + \beta_2x_{2j} + \ldots + \beta_{p_1}x_{p_1j} + \varepsilon_j\)</span>, or <span class="math inline">\(\boldsymbol{y}= X_1\boldsymbol{\beta}_1 + \boldsymbol{\varepsilon}\)</span>,</p></li>
<li><p><span class="math inline">\(Y_j = \beta_0 + \beta_1x_{1j} + \beta_2x_{2j} + \ldots + \beta_{p_1}x_{p_1j} + \beta_{p_1+1}x_{(p_1+1)j} + \ldots + \beta_{p_2}x_{p_2j} + \varepsilon_j\)</span>, or <span class="math inline">\(\boldsymbol{y}= X_1\boldsymbol{\beta}_1 + X_2\boldsymbol{\beta}_2+ \boldsymbol{\varepsilon}\)</span></p></li>
</ol>
<p>with <span class="math inline">\(\varepsilon_j\sim N(0, \sigma^2)\)</span>, and <span class="math inline">\(\varepsilon_{j}\)</span>, <span class="math inline">\(\varepsilon_{k}\)</span> independent <span class="math inline">\((\boldsymbol{\varepsilon}\sim N(\boldsymbol{0},I_n\sigma^2))\)</span>.</p>
<ol type="a">
<li><p>Construct an ANOVA table to compare model (ii) with the null model <span class="math inline">\(Y_j=\beta_0 + \varepsilon_j\)</span>.</p></li>
<li><p>Extend this ANOVA table to compare models (i) and (ii) by further decomposing the regression sum of squares for model (ii).</p></li>
</ol>
<p><strong>Hint:</strong> which residual sum of squares are you interested in to compare models (i) and (ii)?</p>
<p>You should end up with an ANOVA table of the form</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">Source</th>
<th style="text-align: center;">Degrees of freedom</th>
<th style="text-align: center;">Sums of squares</th>
<th style="text-align: center;">Mean square</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Model (i)</td>
<td style="text-align: center;"><span class="math inline">\(p_1\)</span></td>
<td style="text-align: center;">?</td>
<td style="text-align: center;">?</td>
</tr>
<tr class="even">
<td style="text-align: left;">Model (ii)</td>
<td style="text-align: center;"><span class="math inline">\(p_2\)</span></td>
<td style="text-align: center;">?</td>
<td style="text-align: center;">?</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residual</td>
<td style="text-align: center;"><span class="math inline">\(n-p_1-p_2-1\)</span></td>
<td style="text-align: center;">?</td>
<td style="text-align: center;">?</td>
</tr>
<tr class="even">
<td style="text-align: left;">Total</td>
<td style="text-align: center;"><span class="math inline">\(n-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\boldsymbol{y}^{\mathrm{T}}\boldsymbol{y}- n\bar{Y}^2\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<p>The second row of the table gives the <strong>extra sums of squares</strong> for the additional terms in fitting model (ii), over and above those in model (i).</p>
<ol start="3" type="a">
<li>Calculate the extra sum of squares for fitting the terms in model (i), over and above those terms only in model (ii), i.e.&nbsp;those held in <span class="math inline">\(X_2\boldsymbol{\beta}_2\)</span>. Construct an ANOVA table containing both the extra sum of squares for the terms only in model (i) and the extra sum of squares for the terms only in model (ii). Comment on the table.</li>
</ol></li>
</ol>
<details>
<summary>
<b>Solution</b>
</summary>
<ol type="a">
<li><p>From lectures</p>
<table class="table">
<colgroup>
<col style="width: 12%">
<col style="width: 36%">
<col style="width: 30%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Source</th>
<th style="text-align: center;">Degrees of freedom</th>
<th style="text-align: center;">Sums of squares</th>
<th style="text-align: center;">Mean square</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Regression</td>
<td style="text-align: center;"><span class="math inline">\(p_1+p_2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\hat{\boldsymbol{\beta}}^{\mathrm{T}}X^{\mathrm{T}}X\hat{\boldsymbol{\beta}} - n\bar{Y}^2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\left(\hat{\boldsymbol{\beta}}^{\mathrm{T}}X^{\mathrm{T}}X\hat{\boldsymbol{\beta}} - n\bar{Y}^2\right)/(p_1+p_2)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Residual</td>
<td style="text-align: center;"><span class="math inline">\(n-p_1-p_2-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\((\boldsymbol{y}- X\hat{\boldsymbol{\beta}})^{\mathrm{T}}(\boldsymbol{y}- X\hat{\boldsymbol{\beta}})\)</span></td>
<td style="text-align: center;">RSS<span class="math inline">\(/(n-p_1-p_2-1)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: center;"><span class="math inline">\(n-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\boldsymbol{y}^{\mathrm{T}}\boldsymbol{y}- n\bar{Y}^2\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<p>where</p>
<p><span class="math display">\[\begin{align*}
\mbox{RSS(null) - RSS(ii)} &amp; = \boldsymbol{y}^{\mathrm{T}}\boldsymbol{y}- n\bar{Y}^2 - (\boldsymbol{y}- X\hat{\boldsymbol{\beta}})^{\mathrm{T}}(\boldsymbol{y}- X\hat{\boldsymbol{\beta}})\\
&amp; = \boldsymbol{y}^{\mathrm{T}}\boldsymbol{y}- n\bar{Y}^2 - \boldsymbol{y}^{\mathrm{T}}\boldsymbol{y}+ 2\boldsymbol{y}^{\mathrm{T}}X\hat{\boldsymbol{\beta}} - \hat{\boldsymbol{\beta}}^{\mathrm{T}}X^{\mathrm{T}}X\hat{\boldsymbol{\beta}}\\
&amp; = 2\hat{\boldsymbol{\beta}}^{\mathrm{T}}X^{\mathrm{T}}X\hat{\boldsymbol{\beta}} - \hat{\boldsymbol{\beta}}^{\mathrm{T}}X^{\mathrm{T}}X\hat{\boldsymbol{\beta}} - n\bar{Y}^2\\
&amp; = \hat{\boldsymbol{\beta}}^{\mathrm{T}}X^{\mathrm{T}}X\hat{\boldsymbol{\beta}} - n\bar{Y}^2\,.
\end{align*}\]</span></p></li>
<li><p>To compare model (i) with the null model, we compute</p>
<p><span class="math display">\[\begin{align*}
\mbox{RSS(null) - RSS(i)} &amp; = \boldsymbol{y}^{\mathrm{T}}\boldsymbol{y}- N\bar{Y}^2 - (\boldsymbol{y}- X_1\hat{\boldsymbol{\beta}}_1)^{\mathrm{T}}(\boldsymbol{y}- X_1\hat{\boldsymbol{\beta}}_1)\\
&amp; = \hat{\boldsymbol{\beta}}_1^{\mathrm{T}}X_1^{\mathrm{T}}X_1\hat{\boldsymbol{\beta}}_1 - n\bar{Y}^2\,.
\end{align*}\]</span></p>
<p>To compare models (i) and (ii), we compare them both to the null model, and look at the difference between these comparisons:</p>
<p><span class="math display">\[\begin{align*}
\mbox{[RSS(null) - RSS(ii)] - [RSS(null) - RSS(i)]} &amp; = \mbox{RSS(i) - RSS(ii)}\\
&amp; = (\boldsymbol{y}- X_1\hat{\boldsymbol{\beta}}_1)^{\mathrm{T}}(\boldsymbol{y}- X_1\hat{\boldsymbol{\beta}}_1) - (\boldsymbol{y}- X\hat{\boldsymbol{\beta}})^{\mathrm{T}}(\boldsymbol{y}- X\hat{\boldsymbol{\beta}})\\
&amp; = \hat{\boldsymbol{\beta}}^{\mathrm{T}}X^{\mathrm{T}}X\hat{\boldsymbol{\beta}} - \hat{\boldsymbol{\beta}}_1^{\mathrm{T}}X_1^{\mathrm{T}}X_1\hat{\boldsymbol{\beta}}_1\,.
\end{align*}\]</span></p>
<table class="table">
<colgroup>
<col style="width: 12%">
<col style="width: 36%">
<col style="width: 30%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Source</th>
<th style="text-align: center;">Degrees of freedom</th>
<th style="text-align: center;">Sums of squares</th>
<th style="text-align: center;">Mean square</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Regression</td>
<td style="text-align: center;"><span class="math inline">\(p_1+p_2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\hat{\boldsymbol{\beta}}X^{\mathrm{T}}X\hat{\boldsymbol{\beta}} - n\bar{Y}^2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\left(\hat{\boldsymbol{\beta}}X^{\mathrm{T}}X\hat{\boldsymbol{\beta}} - n\bar{Y}^2\right)/(p_1+p_2)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Model (i)</td>
<td style="text-align: center;"><span class="math inline">\(p_1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\hat{\boldsymbol{\beta}}_1^{\mathrm{T}}X_1^{\mathrm{T}}X_1\hat{\boldsymbol{\beta}}_1 - n\bar{Y}^2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\left(\hat{\boldsymbol{\beta}}_1^{\mathrm{T}}X_1^{\mathrm{T}}X_1\hat{\boldsymbol{\beta}}_1 - n\bar{Y}^2\right)/p_1\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Extra due to Model (ii)</td>
<td style="text-align: center;"><span class="math inline">\(p_2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\hat{\boldsymbol{\beta}}^{\mathrm{T}}X^{\mathrm{T}}X\hat{\boldsymbol{\beta}} - \hat{\boldsymbol{\beta}}_1^{\mathrm{T}}X_1^{\mathrm{T}}X_1\hat{\boldsymbol{\beta}}_1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\left(\hat{\boldsymbol{\beta}}^{\mathrm{T}}X^{\mathrm{T}}X\hat{\boldsymbol{\beta}} - \hat{\boldsymbol{\beta}}_1^{\mathrm{T}}X_1^{\mathrm{T}}X_1\hat{\boldsymbol{\beta}}_1\right)/p_2\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Residual</td>
<td style="text-align: center;"><span class="math inline">\(n-p_1-p_2-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\((\boldsymbol{y}- X\hat{\boldsymbol{\beta}})^{\mathrm{T}}(\boldsymbol{y}- X\hat{\boldsymbol{\beta}})\)</span></td>
<td style="text-align: center;">RSS<span class="math inline">\(/(n-p_1-p_2-1)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: center;"><span class="math inline">\(n-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\boldsymbol{y}^{\mathrm{T}}\boldsymbol{y}- n\bar{Y}^2\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table></li>
</ol>
<p>By definition, the Model (i) SS and the Extra SS for Model (ii) sum to the Regression SS.</p>
<ol start="3" type="a">
<li><p>The extra sum of squares for the terms in model (i) over and above those in model (ii) are obtained through comparison of the models</p>
<p>ia. <span class="math inline">\(\boldsymbol{y}= X_2\boldsymbol{\beta}_2 + \boldsymbol{\varepsilon}\)</span>,</p>
<p>iia. <span class="math inline">\(\boldsymbol{y}= X_1\boldsymbol{\beta}_1 + X_2\boldsymbol{\beta}_2+ \boldsymbol{\varepsilon}= X\boldsymbol{\beta}+ \varepsilon\)</span></p>
<p>Extra sum of squares for model (iia):</p>
<p><span class="math display">\[\begin{align*}
\mbox{[RSS(null) - RSS(iia)] - [RSS(null) - RSS(ia)]} &amp; = \mbox{RSS(ia) - RSS(iia)}\\
&amp; = (\boldsymbol{y}- X_2\hat{\boldsymbol{\beta}}_2)^{\mathrm{T}}(\boldsymbol{y}- X_2\hat{\boldsymbol{\beta}}_2) - (\boldsymbol{y}- X\hat{\boldsymbol{\beta}})^{\mathrm{T}}(\boldsymbol{y}- X\hat{\boldsymbol{\beta}})\\
&amp; = \hat{\boldsymbol{\beta}}^{\mathrm{T}}X^{\mathrm{T}}X\hat{\boldsymbol{\beta}} - \hat{\boldsymbol{\beta}}_2^{\mathrm{T}}X_2^{\mathrm{T}}X_2\hat{\boldsymbol{\beta}}_2\,.
\end{align*}\]</span></p>
<p>Hence, an ANOVA table for the extra sums of squares is given by</p>
<table class="table">
<colgroup>
<col style="width: 12%">
<col style="width: 36%">
<col style="width: 30%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Source</th>
<th style="text-align: center;">Degrees of freedom</th>
<th style="text-align: center;">Sums of squares</th>
<th style="text-align: center;">Mean square</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Regression</td>
<td style="text-align: center;"><span class="math inline">\(p_1+p_2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\hat{\boldsymbol{\beta}}X^{\mathrm{T}}X\hat{\boldsymbol{\beta}} - n\bar{Y}^2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\left(\hat{\boldsymbol{\beta}}X^{\mathrm{T}}X\hat{\boldsymbol{\beta}} - n\bar{Y}^2\right)/(p_1+p_2)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Extra Model (i)</td>
<td style="text-align: center;"><span class="math inline">\(p_1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\hat{\boldsymbol{\beta}}^{\mathrm{T}}X^{\mathrm{T}}X\hat{\boldsymbol{\beta}} - \hat{\boldsymbol{\beta}}_2^{\mathrm{T}}X_2^{\mathrm{T}}X_2\hat{\boldsymbol{\beta}}_2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\left(\hat{\boldsymbol{\beta}}^{\mathrm{T}}X^{\mathrm{T}}X\hat{\boldsymbol{\beta}} - \hat{\boldsymbol{\beta}}_2^{\mathrm{T}}X_2^{\mathrm{T}}X_2\hat{\boldsymbol{\beta}}_2\right)/p_1\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Extra Model (ii)</td>
<td style="text-align: center;"><span class="math inline">\(p_2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\hat{\boldsymbol{\beta}}^{\mathrm{T}}X^{\mathrm{T}}X\hat{\boldsymbol{\beta}} - \hat{\boldsymbol{\beta}}_1^{\mathrm{T}}X_1^{\mathrm{T}}X_1\hat{\boldsymbol{\beta}}_1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\left(\hat{\boldsymbol{\beta}}^{\mathrm{T}}X^{\mathrm{T}}X\hat{\boldsymbol{\beta}} - \hat{\boldsymbol{\beta}}_1^{\mathrm{T}}X_1^{\mathrm{T}}X_1\hat{\boldsymbol{\beta}}_1\right)/p_2\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Residual</td>
<td style="text-align: center;"><span class="math inline">\(n-p_1-p_2-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\((\boldsymbol{y}- X\hat{\boldsymbol{\beta}})^{\mathrm{T}}(\boldsymbol{y}- X\hat{\boldsymbol{\beta}})\)</span></td>
<td style="text-align: center;">RSS<span class="math inline">\(/(n-p_1-p_2-1)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Total</td>
<td style="text-align: center;"><span class="math inline">\(n-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\boldsymbol{y}^{\mathrm{T}}\boldsymbol{y}- n\bar{Y}^2\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table></li>
</ol>
<p>Note that for these <em>adjusted</em> sums of squares, in general the extra sum of squares for model (i) and (ii) do not sum to the regression sum of squares. This will only be the case if the columns of <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are mutually orthogonal, i.e.&nbsp;<span class="math inline">\(X_1^{\mathrm{T}}X_2 = \boldsymbol{0}\)</span>.</p>
</details>



<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-Fisher1935" class="csl-entry" role="doc-biblioentry">
Fisher, R. A. (1935) <em>The Design of Experiments</em>. Edinburgh: <span>Oliver and Boyd</span>.
</div>
<div id="ref-Morris2011" class="csl-entry" role="doc-biblioentry">
Morris, M. D. (2011) <em>Design of Experiments: An Introduction Based on Linear Models</em>. Boca Raton: <span>Chapman and Hall/CRC Press</span>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Now, we would use routines such as <code>sample</code> in <code>R</code>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>