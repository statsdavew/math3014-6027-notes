<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Factorial experiments | MATH3014-6027 Design (and Analysis) of Experiments</title>
  <meta name="description" content="Lecture notes for the modules MATH3014 and MATH6027 at the University of Southampton" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Factorial experiments | MATH3014-6027 Design (and Analysis) of Experiments" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Lecture notes for the modules MATH3014 and MATH6027 at the University of Southampton" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Factorial experiments | MATH3014-6027 Design (and Analysis) of Experiments" />
  
  <meta name="twitter:description" content="Lecture notes for the modules MATH3014 and MATH6027 at the University of Southampton" />
  

<meta name="author" content="Dave Woods" />


<meta name="date" content="2022-03-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="blocking.html"/>
<link rel="next" href="block-factorial.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MATH3014-6027</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Motivation, introduction and revision</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#motivation"><i class="fa fa-check"></i><b>1.1</b> Motivation</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#aims-of-experimentation-and-some-examples"><i class="fa fa-check"></i><b>1.2</b> Aims of experimentation and some examples</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#some-definitions"><i class="fa fa-check"></i><b>1.3</b> Some definitions</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#principles"><i class="fa fa-check"></i><b>1.4</b> Principles of experimentation</a><ul>
<li class="chapter" data-level="1.4.1" data-path="intro.html"><a href="intro.html#replication"><i class="fa fa-check"></i><b>1.4.1</b> Replication</a></li>
<li class="chapter" data-level="1.4.2" data-path="intro.html"><a href="intro.html#randomisation"><i class="fa fa-check"></i><b>1.4.2</b> Randomisation</a></li>
<li class="chapter" data-level="1.4.3" data-path="intro.html"><a href="intro.html#intro-blocking"><i class="fa fa-check"></i><b>1.4.3</b> Stratification (or blocking)</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#lin-model-rev"><i class="fa fa-check"></i><b>1.5</b> Revision on the linear model</a><ul>
<li class="chapter" data-level="1.5.1" data-path="intro.html"><a href="intro.html#variance-of-a-predictionfitted-value"><i class="fa fa-check"></i><b>1.5.1</b> Variance of a Prediction/Fitted Value</a></li>
<li class="chapter" data-level="1.5.2" data-path="intro.html"><a href="intro.html#analysis-of-variance-and-r2-as-model-comparison"><i class="fa fa-check"></i><b>1.5.2</b> Analysis of Variance and R<span class="math inline">\(^{2}\)</span> as Model Comparison</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>1.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="crd.html"><a href="crd.html"><i class="fa fa-check"></i><b>2</b> Completely randomised designs</a><ul>
<li class="chapter" data-level="2.1" data-path="crd.html"><a href="crd.html#a-unit-treatment-linear-model"><i class="fa fa-check"></i><b>2.1</b> A unit-treatment linear model</a></li>
<li class="chapter" data-level="2.2" data-path="crd.html"><a href="crd.html#the-partitioned-linear-model"><i class="fa fa-check"></i><b>2.2</b> The partitioned linear model</a></li>
<li class="chapter" data-level="2.3" data-path="crd.html"><a href="crd.html#reduced-normal-equations-for-the-crd"><i class="fa fa-check"></i><b>2.3</b> Reduced normal equations for the CRD</a></li>
<li class="chapter" data-level="2.4" data-path="crd.html"><a href="crd.html#contrasts"><i class="fa fa-check"></i><b>2.4</b> Contrasts</a></li>
<li class="chapter" data-level="2.5" data-path="crd.html"><a href="crd.html#contrast-crd"><i class="fa fa-check"></i><b>2.5</b> Treatment contrast estimators in the CRD</a></li>
<li class="chapter" data-level="2.6" data-path="crd.html"><a href="crd.html#r-crd"><i class="fa fa-check"></i><b>2.6</b> Analysing CRDs in R</a></li>
<li class="chapter" data-level="2.7" data-path="crd.html"><a href="crd.html#multiple-comp"><i class="fa fa-check"></i><b>2.7</b> Multiple comparisons</a></li>
<li class="chapter" data-level="2.8" data-path="crd.html"><a href="crd.html#impact-of-design-choices-on-estimation"><i class="fa fa-check"></i><b>2.8</b> Impact of design choices on estimation</a><ul>
<li class="chapter" data-level="2.8.1" data-path="crd.html"><a href="crd.html#crd-opt-all"><i class="fa fa-check"></i><b>2.8.1</b> Optimal treatment allocation</a></li>
<li class="chapter" data-level="2.8.2" data-path="crd.html"><a href="crd.html#crd-size"><i class="fa fa-check"></i><b>2.8.2</b> Overall size of the experiment</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="crd.html"><a href="crd.html#exercises-1"><i class="fa fa-check"></i><b>2.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="blocking.html"><a href="blocking.html"><i class="fa fa-check"></i><b>3</b> Blocking</a><ul>
<li class="chapter" data-level="3.1" data-path="blocking.html"><a href="blocking.html#unit-block-treatment-model"><i class="fa fa-check"></i><b>3.1</b> Unit-block-treatment model</a></li>
<li class="chapter" data-level="3.2" data-path="blocking.html"><a href="blocking.html#normal-equations"><i class="fa fa-check"></i><b>3.2</b> Normal equations</a></li>
<li class="chapter" data-level="3.3" data-path="blocking.html"><a href="blocking.html#block-anova"><i class="fa fa-check"></i><b>3.3</b> Analysis of variance</a></li>
<li class="chapter" data-level="3.4" data-path="blocking.html"><a href="blocking.html#rcdb"><i class="fa fa-check"></i><b>3.4</b> Randomised complete block designs</a></li>
<li class="chapter" data-level="3.5" data-path="blocking.html"><a href="blocking.html#blocks-orthogonal"><i class="fa fa-check"></i><b>3.5</b> Orthogonal blocking</a></li>
<li class="chapter" data-level="3.6" data-path="blocking.html"><a href="blocking.html#balanced-incomplete-block-designs"><i class="fa fa-check"></i><b>3.6</b> Balanced incomplete block designs</a><ul>
<li class="chapter" data-level="3.6.1" data-path="blocking.html"><a href="blocking.html#construction-of-bibds"><i class="fa fa-check"></i><b>3.6.1</b> Construction of BIBDs</a></li>
<li class="chapter" data-level="3.6.2" data-path="blocking.html"><a href="blocking.html#reduced-normal-equations"><i class="fa fa-check"></i><b>3.6.2</b> Reduced normal equations</a></li>
<li class="chapter" data-level="3.6.3" data-path="blocking.html"><a href="blocking.html#estimation-and-inference"><i class="fa fa-check"></i><b>3.6.3</b> Estimation and inference</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="blocking.html"><a href="blocking.html#exercises-2"><i class="fa fa-check"></i><b>3.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="factorial.html"><a href="factorial.html"><i class="fa fa-check"></i><b>4</b> Factorial experiments</a><ul>
<li class="chapter" data-level="4.1" data-path="factorial.html"><a href="factorial.html#factorial-contrasts"><i class="fa fa-check"></i><b>4.1</b> Factorial contrasts</a><ul>
<li class="chapter" data-level="4.1.1" data-path="factorial.html"><a href="factorial.html#main-effects"><i class="fa fa-check"></i><b>4.1.1</b> Main effects</a></li>
<li class="chapter" data-level="4.1.2" data-path="factorial.html"><a href="factorial.html#interactions"><i class="fa fa-check"></i><b>4.1.2</b> Interactions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="block-factorial.html"><a href="block-factorial.html"><i class="fa fa-check"></i><b>5</b> Blocking in factorial designs</a></li>
<li class="chapter" data-level="6" data-path="fractional-factorial.html"><a href="fractional-factorial.html"><i class="fa fa-check"></i><b>6</b> Fractional factorial designs</a></li>
<li class="chapter" data-level="7" data-path="response-surface-methodology.html"><a href="response-surface-methodology.html"><i class="fa fa-check"></i><b>7</b> Response surface methodology</a></li>
<li class="chapter" data-level="8" data-path="optimal-design-of-experiments.html"><a href="optimal-design-of-experiments.html"><i class="fa fa-check"></i><b>8</b> Optimal design of experiments</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MATH3014-6027 Design (and Analysis) of Experiments</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="factorial" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Factorial experiments</h1>
<p>In Chapters <a href="crd.html#crd">2</a> and <a href="blocking.html#blocking">3</a>, we assumed the objective of the experiment was to investigate <span class="math inline">\(t\)</span> <strong>unstructured</strong> treatments, defined only as a collection of distinct entities (drugs, advertisements, receipes, etc.). That is, there was not necessarily any explicit relationship between the treatments (although we could clearly choose which paticular comparisons between treatments were of interest via choice of contrast).</p>
<p>In many experiments, particularly in industry, engineering and the physical sciences, the treatments are actually defined via the choice of a <strong>level</strong> relating to each of a set of <strong>factors</strong>. We will focus on the commonly occurring case of factors at <strong>two levels</strong>. For example, consider the below experiment from the pharmaceutical industry.</p>
<div class="example">
<p><span id="exm:factorial-desilylation" class="example"><strong>Example 4.1  </strong></span>Desilylation experiment <span class="citation">(Owen <em>et al.</em>, <a href="#ref-Owen2001" role="doc-biblioref">2001</a>)</span></p>
<p>In this experiment, performed at GlaxoSmithKline, the aim was to optimise the desilylation<a href="#fn24" class="footnote-ref" id="fnref24"><sup>24</sup></a> of an ether into an alcohol, which was a key step in the synthesis of a particular antibiotic. There were <span class="math inline">\(t=16\)</span> treatments, defined via the settings of four different factors, as given in Table <a href="factorial.html#tab:factorial-desilylation-data">4.1</a>.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="factorial.html#cb104-1"></a>desilylation &lt;-<span class="st"> </span>FrF2<span class="op">::</span><span class="kw">FrF2</span>(<span class="dt">nruns =</span> <span class="dv">16</span>, <span class="dt">nfactors =</span> <span class="dv">4</span>, <span class="dt">randomize =</span> F,</span>
<span id="cb104-2"><a href="factorial.html#cb104-2"></a>                           <span class="dt">factor.names =</span> <span class="kw">list</span>(<span class="dt">temp =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>), <span class="dt">time =</span> <span class="kw">c</span>(<span class="dv">19</span>, <span class="dv">25</span>),</span>
<span id="cb104-3"><a href="factorial.html#cb104-3"></a>                                               <span class="dt">solvent =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">7</span>), <span class="dt">reagent =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.33</span>)))</span>
<span id="cb104-4"><a href="factorial.html#cb104-4"></a>yield &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">82.93</span>, <span class="fl">94.04</span>, <span class="fl">88.07</span>, <span class="fl">93.97</span>, <span class="fl">77.21</span>, <span class="fl">92.99</span>, <span class="fl">83.60</span>, <span class="fl">94.38</span>, </span>
<span id="cb104-5"><a href="factorial.html#cb104-5"></a>           <span class="fl">88.68</span>, <span class="fl">94.30</span>, <span class="fl">93.00</span>, <span class="fl">93.42</span>, <span class="fl">84.86</span>, <span class="fl">94.26</span>, <span class="fl">88.71</span>, <span class="fl">94.66</span>)</span>
<span id="cb104-6"><a href="factorial.html#cb104-6"></a>desilylation &lt;-<span class="st"> </span><span class="kw">data.frame</span>(desilylation, <span class="dt">yield =</span> yield)</span>
<span id="cb104-7"><a href="factorial.html#cb104-7"></a><span class="kw">rownames</span>(desilylation) &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;Trt&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">16</span>)</span>
<span id="cb104-8"><a href="factorial.html#cb104-8"></a>knitr<span class="op">::</span><span class="kw">kable</span>(desilylation, </span>
<span id="cb104-9"><a href="factorial.html#cb104-9"></a>             <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;Temp (degrees C)&quot;</span>, <span class="st">&quot;Time (hours)&quot;</span>, <span class="st">&quot;Solvent (vol.)&quot;</span>, </span>
<span id="cb104-10"><a href="factorial.html#cb104-10"></a>                           <span class="st">&quot;Reagent (equiv.)&quot;</span>, <span class="st">&quot;Yield (%)&quot;</span>),</span>
<span id="cb104-11"><a href="factorial.html#cb104-11"></a>             <span class="dt">caption =</span> <span class="st">&quot;Desilylation experiment: 16 treatments defined </span></span>
<span id="cb104-12"><a href="factorial.html#cb104-12"></a><span class="st">             by settings of four factors, with response (yield).&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:factorial-desilylation-data">Table 4.1: </span>Desilylation experiment: 16 treatments defined
by settings of four factors, with response (yield).</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Temp (degrees C)</th>
<th align="left">Time (hours)</th>
<th align="left">Solvent (vol.)</th>
<th align="left">Reagent (equiv.)</th>
<th align="right">Yield (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Trt 1</td>
<td align="left">10</td>
<td align="left">19</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="right">82.93</td>
</tr>
<tr class="even">
<td align="left">Trt 2</td>
<td align="left">20</td>
<td align="left">19</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="right">94.04</td>
</tr>
<tr class="odd">
<td align="left">Trt 3</td>
<td align="left">10</td>
<td align="left">25</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="right">88.07</td>
</tr>
<tr class="even">
<td align="left">Trt 4</td>
<td align="left">20</td>
<td align="left">25</td>
<td align="left">5</td>
<td align="left">1</td>
<td align="right">93.97</td>
</tr>
<tr class="odd">
<td align="left">Trt 5</td>
<td align="left">10</td>
<td align="left">19</td>
<td align="left">7</td>
<td align="left">1</td>
<td align="right">77.21</td>
</tr>
<tr class="even">
<td align="left">Trt 6</td>
<td align="left">20</td>
<td align="left">19</td>
<td align="left">7</td>
<td align="left">1</td>
<td align="right">92.99</td>
</tr>
<tr class="odd">
<td align="left">Trt 7</td>
<td align="left">10</td>
<td align="left">25</td>
<td align="left">7</td>
<td align="left">1</td>
<td align="right">83.60</td>
</tr>
<tr class="even">
<td align="left">Trt 8</td>
<td align="left">20</td>
<td align="left">25</td>
<td align="left">7</td>
<td align="left">1</td>
<td align="right">94.38</td>
</tr>
<tr class="odd">
<td align="left">Trt 9</td>
<td align="left">10</td>
<td align="left">19</td>
<td align="left">5</td>
<td align="left">1.33</td>
<td align="right">88.68</td>
</tr>
<tr class="even">
<td align="left">Trt 10</td>
<td align="left">20</td>
<td align="left">19</td>
<td align="left">5</td>
<td align="left">1.33</td>
<td align="right">94.30</td>
</tr>
<tr class="odd">
<td align="left">Trt 11</td>
<td align="left">10</td>
<td align="left">25</td>
<td align="left">5</td>
<td align="left">1.33</td>
<td align="right">93.00</td>
</tr>
<tr class="even">
<td align="left">Trt 12</td>
<td align="left">20</td>
<td align="left">25</td>
<td align="left">5</td>
<td align="left">1.33</td>
<td align="right">93.42</td>
</tr>
<tr class="odd">
<td align="left">Trt 13</td>
<td align="left">10</td>
<td align="left">19</td>
<td align="left">7</td>
<td align="left">1.33</td>
<td align="right">84.86</td>
</tr>
<tr class="even">
<td align="left">Trt 14</td>
<td align="left">20</td>
<td align="left">19</td>
<td align="left">7</td>
<td align="left">1.33</td>
<td align="right">94.26</td>
</tr>
<tr class="odd">
<td align="left">Trt 15</td>
<td align="left">10</td>
<td align="left">25</td>
<td align="left">7</td>
<td align="left">1.33</td>
<td align="right">88.71</td>
</tr>
<tr class="even">
<td align="left">Trt 16</td>
<td align="left">20</td>
<td align="left">25</td>
<td align="left">7</td>
<td align="left">1.33</td>
<td align="right">94.66</td>
</tr>
</tbody>
</table>
<p>Each treatment is defined by the choice of one of two levels for each of the four factors. In the <code>R</code> code above, we have used the function <code>FrF2</code> (from the package of the same name) to generate all <span class="math inline">\(t = 2^4 = 16\)</span> combinations of the two levels of these four factors. We come back to this function later in the chapter.</p>
</div>
<p>This <strong>factorial treatment structure</strong> lends itself to certain treatment contrasts being of natural interest.</p>
<div id="factorial-contrasts" class="section level2">
<h2><span class="header-section-number">4.1</span> Factorial contrasts</h2>
<p>Throughout this chapter, we will assume there are no blocks or other restrictions on randomisation, and so we will assume a completely randomised design can be used. We start by assuming the same unit-treatment model as Chapter <a href="crd.html#crd">2</a>:</p>
<p><span class="math display" id="eq:factorial-utm">\[\begin{equation}
y_{ij} = \mu + \tau_i + \varepsilon_{ij}\,, \quad i = 1, \ldots, t; j = 1, \ldots, n_i\,, \tag{4.1}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(y_{ij}\)</span> is the response from the <span class="math inline">\(j\)</span>th application of treatment <span class="math inline">\(i\)</span>, <span class="math inline">\(\mu\)</span> is a constant parameter, <span class="math inline">\(\tau_i\)</span> is the effect of the <span class="math inline">\(i\)</span>th treatment, and <span class="math inline">\(\varepsilon_{ij}\)</span> is the random individual effect from each experimental unit with <span class="math inline">\(\varepsilon_{ij} \sim N(0, \sigma^2)\)</span> independent of other errors.</p>
<p>Now, the number of treatments <span class="math inline">\(t = 2^f\)</span>, where <span class="math inline">\(f\)</span> equals the number of factors in the experiment.</p>
<p>For Example <a href="factorial.html#exm:factorial-desilylation">4.1</a>, we have <span class="math inline">\(t = 2^4 = 16\)</span> and <span class="math inline">\(n_i = 1\)</span> for all <span class="math inline">\(i=1,\ldots, 16\)</span>; that is, each of the 16 treatments are replicated once. In general, we shall assume common treatment replication <span class="math inline">\(n_i = r \ge 1\)</span>.</p>
<p>If we fit model <a href="factorial.html#eq:factorial-utm">(4.1)</a> and compute the ANOVA table, we notice a particular issue with this design.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="factorial.html#cb105-1"></a>desilylation &lt;-<span class="st"> </span><span class="kw">data.frame</span>(desilylation, <span class="dt">trt =</span> <span class="kw">factor</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">16</span>))</span>
<span id="cb105-2"><a href="factorial.html#cb105-2"></a>desilylation.lm &lt;-<span class="st"> </span><span class="kw">lm</span>(yield <span class="op">~</span><span class="st"> </span>trt, <span class="dt">data =</span> desilylation)</span>
<span id="cb105-3"><a href="factorial.html#cb105-3"></a><span class="kw">anova</span>(desilylation.lm)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: yield
##           Df Sum Sq Mean Sq F value Pr(&gt;F)
## trt       15    427    28.5     NaN    NaN
## Residuals  0      0     NaN</code></pre>
<p>All available degrees of freedom are being used to estimate parameters in the mean (<span class="math inline">\(\mu\)</span> and the treatment effects <span class="math inline">\(\tau_i\)</span>). There are no degrees of freedom left to estimate <span class="math inline">\(\sigma^2\)</span>. This is due to a lack of treatment replication. Without replication in the design, model <a href="factorial.html#eq:factorial-utm">(4.1)</a> is <strong>saturated</strong>, with as many treatments as there are observations and an unbiased estimate of <span class="math inline">\(\sigma^2\)</span> cannot be obtained. We will return to this issue later.</p>
<div id="main-effects" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Main effects</h3>
<p>Studying Table <a href="factorial.html#tab:factorial-desilylation-data">4.1</a>, there are some comparisons between treatments which are obviously of interest. For example, comparing the average effect from the first 8 treatments with the average effect of the second 8, using</p>
<p><span class="math display">\[
\boldsymbol{c}^{\mathrm{T}}\boldsymbol{\tau} = \sum_{i=1}^tc_i\tau_i\,,
\]</span>
with</p>
<p><span class="math display">\[
\boldsymbol{c}^{\mathrm{T}} = (-\boldsymbol{1}_8^{\mathrm{T}}, \boldsymbol{1}_8^{\mathrm{T}}) / 8\,.
\]</span></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="factorial.html#cb107-1"></a>desilylation.emm &lt;-<span class="st"> </span>emmeans<span class="op">::</span><span class="kw">emmeans</span>(desilylation.lm, <span class="op">~</span><span class="st"> </span>trt)</span>
<span id="cb107-2"><a href="factorial.html#cb107-2"></a>reagent_me.emmc &lt;-<span class="st"> </span><span class="cf">function</span>(levs) <span class="kw">data.frame</span>(<span class="st">&#39;reagent m.e.&#39;</span> =<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="kw">rep</span>(<span class="dv">8</span>, <span class="dv">2</span>)) <span class="op">/</span><span class="st"> </span><span class="dv">8</span>)</span>
<span id="cb107-3"><a href="factorial.html#cb107-3"></a>emmeans<span class="op">::</span><span class="kw">contrast</span>(desilylation.emm, <span class="st">&#39;reagent_me&#39;</span>)</span></code></pre></div>
<pre><code>##  contrast     estimate  SE df t.ratio p.value
##  reagent.m.e.     3.09 NaN  0     NaN     NaN</code></pre>
<p>This contrast compares the average treatment effect from the 8 treatments which have <code>reagent</code> set to its low level (1 equiv.) to the average effect from the 8 treatments which have <code>reagent</code> set to its high level. This is a “fair” comparison, as both of these sets of treatments have each of the combinations of the factors <code>temp</code>, <code>time</code> and <code>solvent</code> occuring equally often (twice here). Hence, the <strong>main effect</strong> of <code>reagent</code> is averaged over the levels of the other three factors.</p>
<p>As in Chapter <a href="crd.html#crd">2</a>, we can estimate this treatment contrast by applying the same contrast coefficients to the treatment means,</p>
<p><span class="math display">\[
\widehat{\boldsymbol{c}^{\mathrm{T}}\boldsymbol{\tau}} = \sum_{i=1}^tc_i\bar{y}_{i.}\,,
\]</span>
where, for this experiment, each <span class="math inline">\(\bar{y}_{i.}\)</span> is the mean of a single observation (as there is no treatment replication). We see that inference about this contrast is not possible, as no standard error can be obtained.</p>
<div class="definition">
<p><span id="def:main-effect" class="definition"><strong>Definition 4.1  </strong></span>The <strong>main effect</strong> of a factor <span class="math inline">\(A\)</span> is defined as the difference in the average response from the high and low levels of the factor</p>
<p><span class="math display">\[
\mbox{ME}(A) = \bar{y}(A+) - \bar{y}(A-)\,,
\]</span>
where <span class="math inline">\(\bar{y}(A+)\)</span> is the average response when factor <span class="math inline">\(A\)</span> is set to its high level, averaged across all combinations of levels of the other factors (with <span class="math inline">\(\bar{y}(A+)\)</span> defined similarly for the low level of <span class="math inline">\(A\)</span>).</p>
</div>
<p>As we have averaged the response across the levels of the other factors, the intepretation of the main effect extends beyond this experiment. That is, we can use it to infer something about the system under study. Assuming model <a href="factorial.html#eq:factorial-utm">(4.1)</a> is correct, any variation in the main effect can only come from random error in the observations. In fact,</p>
<p><span class="math display">\[\begin{align*}
\mbox{var}\{ME(A)\} &amp; = \frac{\sigma^2}{n/2} + \frac{\sigma^2}{n/2} \\
&amp; = \frac{4\sigma^2}{n}\,,
\end{align*}\]</span></p>
<p>and assuming <span class="math inline">\(r&gt;1\)</span>,</p>
<p><span class="math display" id="eq:factorial-sigma-hat-2">\[\begin{equation}
\hat{\sigma}^2 = \frac{1}{2^f(r-1)} \sum_{i=1}^{2^f}\sum_{j=1}^r(y_{ij} - \bar{y}_{i.})^2\,,
\tag{4.2}
\end{equation}\]</span></p>
<p>which is the residual mean square.</p>
<p>For Example <a href="factorial.html#exm:factorial-desilylation">4.1</a>, we can also calculate main effect estimates for the other three factors by defining appropriate contrasts in the treatments.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="factorial.html#cb109-1"></a>contrast.mat &lt;-<span class="st"> </span>FrF2<span class="op">::</span><span class="kw">FrF2</span>(<span class="dt">nruns =</span> <span class="dv">16</span>, <span class="dt">nfactors =</span> <span class="dv">4</span>, <span class="dt">randomize =</span> F, </span>
<span id="cb109-2"><a href="factorial.html#cb109-2"></a>                           <span class="dt">factor.names =</span> <span class="kw">c</span>(<span class="st">&quot;temp&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;solvent&quot;</span>, <span class="st">&quot;reagent&quot;</span>))</span>
<span id="cb109-3"><a href="factorial.html#cb109-3"></a>fac.contrasts.emmc &lt;-<span class="st"> </span><span class="cf">function</span>(levs) </span>
<span id="cb109-4"><a href="factorial.html#cb109-4"></a>  dplyr<span class="op">::</span><span class="kw">mutate_all</span>(contrast.mat, <span class="cf">function</span>(x) <span class="kw">scale</span>(<span class="kw">as.numeric</span>(x), <span class="dt">scale =</span> <span class="dv">4</span>))</span>
<span id="cb109-5"><a href="factorial.html#cb109-5"></a>main_effect_contrasts &lt;-<span class="st"> </span><span class="kw">fac.contrasts.emmc</span>()</span>
<span id="cb109-6"><a href="factorial.html#cb109-6"></a><span class="kw">rownames</span>(main_effect_contrasts) &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;Trt&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">16</span>)</span>
<span id="cb109-7"><a href="factorial.html#cb109-7"></a>knitr<span class="op">::</span><span class="kw">kable</span>(main_effect_contrasts, <span class="dt">caption =</span> <span class="st">&#39;Desilylation experiment: main effect contrast coefficients&#39;</span>, <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;Temperature&quot;</span>, <span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Solvent&quot;</span>, <span class="st">&quot;Reagent&quot;</span>))</span></code></pre></div>
<table>
<caption><span id="tab:desilylation-all-me-contrasts">Table 4.2: </span>Desilylation experiment: main effect contrast coefficients</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Temperature</th>
<th align="right">Time</th>
<th align="right">Solvent</th>
<th align="right">Reagent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Trt 1</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
</tr>
<tr class="even">
<td align="left">Trt 2</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
</tr>
<tr class="odd">
<td align="left">Trt 3</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
</tr>
<tr class="even">
<td align="left">Trt 4</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
</tr>
<tr class="odd">
<td align="left">Trt 5</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
</tr>
<tr class="even">
<td align="left">Trt 6</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
</tr>
<tr class="odd">
<td align="left">Trt 7</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
</tr>
<tr class="even">
<td align="left">Trt 8</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
</tr>
<tr class="odd">
<td align="left">Trt 9</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
</tr>
<tr class="even">
<td align="left">Trt 10</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
</tr>
<tr class="odd">
<td align="left">Trt 11</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
</tr>
<tr class="even">
<td align="left">Trt 12</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
</tr>
<tr class="odd">
<td align="left">Trt 13</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
</tr>
<tr class="even">
<td align="left">Trt 14</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
</tr>
<tr class="odd">
<td align="left">Trt 15</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
</tr>
<tr class="even">
<td align="left">Trt 16</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
</tr>
</tbody>
</table>
<p>Estimates can be obtained by applying these coefficients to the observed treatment means.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="factorial.html#cb110-1"></a><span class="kw">t</span>(<span class="kw">as.matrix</span>(main_effect_contrasts)) <span class="op">%*%</span><span class="st"> </span>yield</span></code></pre></div>
<pre><code>##           [,1]
## temp     8.120
## time     2.567
## solvent -2.218
## reagent  3.087</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="factorial.html#cb112-1"></a>emmeans<span class="op">::</span><span class="kw">contrast</span>(desilylation.emm, <span class="st">&#39;fac.contrasts&#39;</span>)</span></code></pre></div>
<pre><code>##  contrast estimate  SE df t.ratio p.value
##  temp         8.12 NaN  0     NaN     NaN
##  time         2.57 NaN  0     NaN     NaN
##  solvent     -2.22 NaN  0     NaN     NaN
##  reagent      3.09 NaN  0     NaN     NaN</code></pre>
<p>Main effects are often displayed graphically, using <strong>main effect plots</strong> which simply plot the average response for each factor level, joined by a line. The larger the main effect, the larger the slope of the line (or the bigger the difference between the averages). Figure <a href="factorial.html#fig:desilylation-me-plots">4.1</a> presents the four main effect plots for Example <a href="factorial.html#exm:factorial-desilylation">4.1</a>.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="factorial.html#cb114-1"></a><span class="co">## calculate the means</span></span>
<span id="cb114-2"><a href="factorial.html#cb114-2"></a>temp_bar &lt;-<span class="st"> </span><span class="kw">aggregate</span>(yield <span class="op">~</span><span class="st"> </span>temp, <span class="dt">data =</span> desilylation, <span class="dt">FUN =</span> mean)</span>
<span id="cb114-3"><a href="factorial.html#cb114-3"></a>time_bar &lt;-<span class="st"> </span><span class="kw">aggregate</span>(yield <span class="op">~</span><span class="st"> </span>time, <span class="dt">data =</span> desilylation, <span class="dt">FUN =</span> mean)</span>
<span id="cb114-4"><a href="factorial.html#cb114-4"></a>solvent_bar &lt;-<span class="st"> </span><span class="kw">aggregate</span>(yield <span class="op">~</span><span class="st"> </span>solvent, <span class="dt">data =</span> desilylation, <span class="dt">FUN =</span> mean)</span>
<span id="cb114-5"><a href="factorial.html#cb114-5"></a>reagent_bar &lt;-<span class="st"> </span><span class="kw">aggregate</span>(yield <span class="op">~</span><span class="st"> </span>reagent, <span class="dt">data =</span> desilylation, <span class="dt">FUN =</span> mean)</span>
<span id="cb114-6"><a href="factorial.html#cb114-6"></a></span>
<span id="cb114-7"><a href="factorial.html#cb114-7"></a><span class="co">## convert factors to numeric</span></span>
<span id="cb114-8"><a href="factorial.html#cb114-8"></a>fac_to_num &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">as.numeric</span>(<span class="kw">as.character</span>(x))</span>
<span id="cb114-9"><a href="factorial.html#cb114-9"></a>temp_bar<span class="op">$</span>temp &lt;-<span class="st"> </span><span class="kw">fac_to_num</span>(temp_bar<span class="op">$</span>temp)</span>
<span id="cb114-10"><a href="factorial.html#cb114-10"></a>time_bar<span class="op">$</span>time &lt;-<span class="st"> </span><span class="kw">fac_to_num</span>(time_bar<span class="op">$</span>time)</span>
<span id="cb114-11"><a href="factorial.html#cb114-11"></a>solvent_bar<span class="op">$</span>solvent &lt;-<span class="st"> </span><span class="kw">fac_to_num</span>(solvent_bar<span class="op">$</span>solvent)</span>
<span id="cb114-12"><a href="factorial.html#cb114-12"></a>reagent_bar<span class="op">$</span>reagent &lt;-<span class="st"> </span><span class="kw">fac_to_num</span>(reagent_bar<span class="op">$</span>reagent)</span>
<span id="cb114-13"><a href="factorial.html#cb114-13"></a></span>
<span id="cb114-14"><a href="factorial.html#cb114-14"></a><span class="co">## main effect plots</span></span>
<span id="cb114-15"><a href="factorial.html#cb114-15"></a>plotmin &lt;-<span class="st"> </span><span class="kw">min</span>(temp_bar<span class="op">$</span>yield, time_bar<span class="op">$</span>yield, solvent_bar<span class="op">$</span>yield, reagent_bar<span class="op">$</span>yield)</span>
<span id="cb114-16"><a href="factorial.html#cb114-16"></a>plotmax &lt;-<span class="st"> </span><span class="kw">max</span>(temp_bar<span class="op">$</span>yield, time_bar<span class="op">$</span>yield, solvent_bar<span class="op">$</span>yield, reagent_bar<span class="op">$</span>yield)</span>
<span id="cb114-17"><a href="factorial.html#cb114-17"></a><span class="kw">par</span>(<span class="dt">cex =</span> <span class="dv">2</span>)</span>
<span id="cb114-18"><a href="factorial.html#cb114-18"></a><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>), <span class="dt">respect =</span> T)</span>
<span id="cb114-19"><a href="factorial.html#cb114-19"></a><span class="kw">plot</span>(temp_bar, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(plotmin, plotmax))</span>
<span id="cb114-20"><a href="factorial.html#cb114-20"></a><span class="kw">plot</span>(time_bar, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(plotmin, plotmax))</span>
<span id="cb114-21"><a href="factorial.html#cb114-21"></a><span class="kw">plot</span>(solvent_bar, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(plotmin, plotmax))</span>
<span id="cb114-22"><a href="factorial.html#cb114-22"></a><span class="kw">plot</span>(reagent_bar, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(plotmin, plotmax))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:desilylation-me-plots"></span>
<img src="bookdown_math3014-6027_files/figure-html/desilylation-me-plots-1.png" alt="Desilylation experiment: main effect plots" width="672" />
<p class="caption">
Figure 4.1: Desilylation experiment: main effect plots
</p>
</div>
</div>
<div id="interactions" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Interactions</h3>
<p>Another contrast that could be of interest in Example <a href="factorial.html#exm:factorial-desilylation">4.1</a> has coefficients</p>
<p><span class="math display">\[
\boldsymbol{c}^{\mathrm{T}} = (\boldsymbol{1}_4^{\mathrm{T}}, -\boldsymbol{1}_8^{\mathrm{T}}, \boldsymbol{1}_4^{\mathrm{T}}) / 8\,.
\]</span>
This contrast measures the different between the average treatment effect from treatments 1-4, 13-16 and treatments 5-12. Checking back against Table <a href="factorial.html#tab:factorial-desilylation-data">4.1</a>, we see this is comparing those treatments where <code>solvent</code> and <code>reagent</code> are both set to their low (1-4) or high (13-16) level against those treatments where one of the two factors is set high and the other is set low (5-12).</p>
<p>Focusing on <code>reagent</code>, if the effect of this factor on the response was independent of the level to which <code>solvent</code> has been set, you would expect this contrast to be zero - changing from the high to low level of <code>reagent</code> should affect the response in the same way, regardless of the setting of <code>solvent</code>. This argument can be reversed, focussing on the effect of <code>solvent</code>. Therefore, if this contrast is large, we say the two factors <strong>interact</strong>.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="factorial.html#cb115-1"></a>sol_reg_int.emmc &lt;-<span class="st"> </span><span class="cf">function</span>(levels) </span>
<span id="cb115-2"><a href="factorial.html#cb115-2"></a>  <span class="kw">data.frame</span>(<span class="st">&#39;reagent x solvent&#39;</span> =<span class="st"> </span><span class="fl">.125</span> <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">4</span>), <span class="kw">rep</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">8</span>), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">4</span>)))</span>
<span id="cb115-3"><a href="factorial.html#cb115-3"></a>emmeans<span class="op">::</span><span class="kw">contrast</span>(desilylation.emm, <span class="st">&#39;sol_reg_int&#39;</span>)</span></code></pre></div>
<pre><code>##  contrast          estimate  SE df t.ratio p.value
##  reagent.x.solvent     0.49 NaN  0     NaN     NaN</code></pre>
<p>For Example <a href="factorial.html#exm:factorial-desilylation">4.1</a>, this interaction contrast seems quite small, although of course without an estimate of the standard error we are still lacking a formal method to judge this.</p>
<p>It is somewhat more informative to consider the above interaction contrast as the average difference in two “sub-contrasts”</p>
<p><span class="math display">\[
\boldsymbol{c}^{\mathrm{T}}\boldsymbol{\tau} = \frac{1}{2}\left\{\frac{1}{4}\left(\tau_{13} + \tau_{14} + \tau_{15} + \tau_{16} - \tau_5 - \tau_6 - \tau_7 - \tau_8\right)
- \frac{1}{4}\left(\tau_9 + \tau_{10} + \tau_{11} + \tau_{12} - \tau_1 - \tau_2 - \tau_3 - \tau_4\right) \right\}\,,
\]</span>
The first component in the above expression is the effect of changing <code>reagent</code> from high to low <strong>given <code>solvent</code> is set to it’s high level</strong>. The second component the effect of changing <code>reagent</code> from high to low <strong>given <code>solvent</code> is set to it’s low level</strong>. This leads to our definition of a two-factor interaction.</p>
<div class="definition">
<p><span id="def:two-factor-interaction" class="definition"><strong>Definition 4.2  </strong></span>The <strong>two-factor interaction</strong> between factors <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> is defined as the average difference in main effect of factor <span class="math inline">\(A\)</span> when computed at the high and low levels of factor <span class="math inline">\(B\)</span>.</p>
<p><span class="math display">\[\begin{align*}
\mbox{Int}(A, B) &amp; = \frac{1}{2}\left\{\mbox{ME}(A\mid B+) - \mbox{ME}(A \mid B-)\right\} \\
&amp; = \frac{1}{2}\left\{\mbox{ME}(B \mid A+) - \mbox{ME}(B \mid A-)\right\} \\
&amp; = \bar{y}(A+, B+) - \bar{y}(A-, B+) + \bar{y}(A+, B-) - \bar{y}(A-, B-)\,,
\end{align*}\]</span></p>
<p>where <span class="math inline">\(\bar{y}(A+, B-)\)</span> is the average response when factor <span class="math inline">\(A\)</span> is set to its high level and factor <span class="math inline">\(B\)</span> is set to its low level, averaged across all combinations of levels of the other factors, and other averages are defined similarly. The conditional main effects of factor <span class="math inline">\(A\)</span> when factor <span class="math inline">\(B\)</span> is set to its high level is defined as</p>
<p><span class="math display">\[
\mbox{ME}(A\mid B+) = \bar{y}(A+, B+) - \bar{y}(A-, B+)\,,
\]</span></p>
<p>with similar definitions for other conditional main effects.</p>
</div>
<p>As the sum of the squared contrast coefficients is the same for two-factor interactions as for main effects, the variance of the contrast estimator is also the same.</p>
<p><span class="math display">\[
\mbox{var}\left\{\mbox{Int}(A, B)\right\} = \frac{4\sigma^2}{n}\,.
\]</span>
For Example <a href="factorial.html#exm:factorial-desilylation">4.1</a> we can calculate two-factor interactions for all <span class="math inline">\({4 \choose 2} = 6\)</span> pairs of factors. The simplest way to calculate the contrast coefficients is as the elementwise, or Schur, product of the unscaled main effect contrasts (before dividing by <span class="math inline">\(n/2\)</span>).</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="factorial.html#cb117-1"></a>fac.contrasts.int.emmc &lt;-<span class="st"> </span><span class="cf">function</span>(levs) {</span>
<span id="cb117-2"><a href="factorial.html#cb117-2"></a>  <span class="kw">with</span>(<span class="kw">sqrt</span>(<span class="dv">8</span>) <span class="op">*</span><span class="st"> </span>main_effect_contrasts, {</span>
<span id="cb117-3"><a href="factorial.html#cb117-3"></a>    <span class="kw">data.frame</span>(<span class="st">&#39;tem_x_tim&#39;</span> =<span class="st"> </span>temp <span class="op">*</span><span class="st"> </span>time,</span>
<span id="cb117-4"><a href="factorial.html#cb117-4"></a>               <span class="st">&#39;tem_x_sol&#39;</span> =<span class="st"> </span>temp <span class="op">*</span><span class="st"> </span>solvent,</span>
<span id="cb117-5"><a href="factorial.html#cb117-5"></a>               <span class="st">&#39;tem_x_rea&#39;</span> =<span class="st"> </span>temp <span class="op">*</span><span class="st"> </span>reagent,</span>
<span id="cb117-6"><a href="factorial.html#cb117-6"></a>               <span class="st">&#39;tim_x_sol&#39;</span> =<span class="st"> </span>time <span class="op">*</span><span class="st"> </span>solvent,</span>
<span id="cb117-7"><a href="factorial.html#cb117-7"></a>               <span class="st">&#39;tim_x_rea&#39;</span> =<span class="st"> </span>time <span class="op">*</span><span class="st"> </span>reagent,</span>
<span id="cb117-8"><a href="factorial.html#cb117-8"></a>               <span class="st">&#39;sol_x_rea&#39;</span> =<span class="st"> </span>solvent <span class="op">*</span><span class="st"> </span>reagent)</span>
<span id="cb117-9"><a href="factorial.html#cb117-9"></a>  })</span>
<span id="cb117-10"><a href="factorial.html#cb117-10"></a>}</span>
<span id="cb117-11"><a href="factorial.html#cb117-11"></a>two_fi_contrasts &lt;-<span class="st"> </span><span class="kw">fac.contrasts.int.emmc</span>()</span>
<span id="cb117-12"><a href="factorial.html#cb117-12"></a><span class="kw">rownames</span>(two_fi_contrasts) &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;Trt&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">16</span>)</span>
<span id="cb117-13"><a href="factorial.html#cb117-13"></a>knitr<span class="op">::</span><span class="kw">kable</span>(two_fi_contrasts, <span class="dt">caption =</span> <span class="st">&#39;Desilylation experiment: two-factor interaction contrast coefficients&#39;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:desilylation-2fi-interactions">Table 4.3: </span>Desilylation experiment: two-factor interaction contrast coefficients</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">tem_x_tim</th>
<th align="right">tem_x_sol</th>
<th align="right">tem_x_rea</th>
<th align="right">tim_x_sol</th>
<th align="right">tim_x_rea</th>
<th align="right">sol_x_rea</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Trt 1</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
</tr>
<tr class="even">
<td align="left">Trt 2</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
</tr>
<tr class="odd">
<td align="left">Trt 3</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
</tr>
<tr class="even">
<td align="left">Trt 4</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
</tr>
<tr class="odd">
<td align="left">Trt 5</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
</tr>
<tr class="even">
<td align="left">Trt 6</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
</tr>
<tr class="odd">
<td align="left">Trt 7</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
</tr>
<tr class="even">
<td align="left">Trt 8</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
</tr>
<tr class="odd">
<td align="left">Trt 9</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
</tr>
<tr class="even">
<td align="left">Trt 10</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
</tr>
<tr class="odd">
<td align="left">Trt 11</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
</tr>
<tr class="even">
<td align="left">Trt 12</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
</tr>
<tr class="odd">
<td align="left">Trt 13</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
</tr>
<tr class="even">
<td align="left">Trt 14</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
</tr>
<tr class="odd">
<td align="left">Trt 15</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
<td align="right">-0.125</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
</tr>
<tr class="even">
<td align="left">Trt 16</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
<td align="right">0.125</td>
</tr>
</tbody>
</table>
<p>Estimates of the interaction contrasts can again by found by considering the equivalent contrasts in the observed treatment means.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="factorial.html#cb118-1"></a><span class="kw">t</span>(<span class="kw">as.matrix</span>(two_fi_contrasts)) <span class="op">%*%</span><span class="st"> </span>yield</span></code></pre></div>
<pre><code>##             [,1]
## tem_x_tim -2.357
## tem_x_sol  2.358
## tem_x_rea -2.773
## tim_x_sol  0.440
## tim_x_rea -0.645
## sol_x_rea  0.490</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="factorial.html#cb120-1"></a>emmeans<span class="op">::</span><span class="kw">contrast</span>(desilylation.emm, <span class="st">&#39;fac.contrasts.int&#39;</span>)</span></code></pre></div>
<pre><code>##  contrast  estimate  SE df t.ratio p.value
##  tem_x_tim   -2.357 NaN  0     NaN     NaN
##  tem_x_sol    2.357 NaN  0     NaN     NaN
##  tem_x_rea   -2.772 NaN  0     NaN     NaN
##  tim_x_sol    0.440 NaN  0     NaN     NaN
##  tim_x_rea   -0.645 NaN  0     NaN     NaN
##  sol_x_rea    0.490 NaN  0     NaN     NaN</code></pre>
<p>As with main effects, interactions are often displayed graphically using <strong>interaction</strong> plots, plotting average responses for each pairwise combination of factors, joined by lines.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="factorial.html#cb122-1"></a><span class="co">## calculate the means</span></span>
<span id="cb122-2"><a href="factorial.html#cb122-2"></a>temp_time &lt;-<span class="st"> </span><span class="kw">aggregate</span>(yield <span class="op">~</span><span class="st"> </span>temp <span class="op">+</span><span class="st"> </span>time, <span class="dt">data =</span> desilylation, <span class="dt">FUN =</span> mean, <span class="dt">simplify =</span> T)</span>
<span id="cb122-3"><a href="factorial.html#cb122-3"></a>temp_solvent &lt;-<span class="st"> </span><span class="kw">aggregate</span>(yield <span class="op">~</span><span class="st"> </span>temp <span class="op">+</span><span class="st"> </span>solvent, <span class="dt">data =</span> desilylation, <span class="dt">FUN =</span> mean)</span>
<span id="cb122-4"><a href="factorial.html#cb122-4"></a>temp_reagent &lt;-<span class="st"> </span><span class="kw">aggregate</span>(yield <span class="op">~</span><span class="st"> </span>temp <span class="op">+</span><span class="st"> </span>reagent, <span class="dt">data =</span> desilylation, <span class="dt">FUN =</span> mean)</span>
<span id="cb122-5"><a href="factorial.html#cb122-5"></a>time_solvent &lt;-<span class="st"> </span><span class="kw">aggregate</span>(yield <span class="op">~</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span>solvent, <span class="dt">data =</span> desilylation, <span class="dt">FUN =</span> mean)</span>
<span id="cb122-6"><a href="factorial.html#cb122-6"></a>time_reagent &lt;-<span class="st"> </span><span class="kw">aggregate</span>(yield <span class="op">~</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span>reagent, <span class="dt">data =</span> desilylation, <span class="dt">FUN =</span> mean)</span>
<span id="cb122-7"><a href="factorial.html#cb122-7"></a>solvent_reagent &lt;-<span class="st"> </span><span class="kw">aggregate</span>(yield <span class="op">~</span><span class="st"> </span>solvent <span class="op">+</span><span class="st"> </span>reagent, <span class="dt">data =</span> desilylation, <span class="dt">FUN =</span> mean)</span>
<span id="cb122-8"><a href="factorial.html#cb122-8"></a></span>
<span id="cb122-9"><a href="factorial.html#cb122-9"></a><span class="co">## convert factors to numeric</span></span>
<span id="cb122-10"><a href="factorial.html#cb122-10"></a>temp_time[, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(temp_time[, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dv">2</span>, fac_to_num)</span>
<span id="cb122-11"><a href="factorial.html#cb122-11"></a>temp_solvent[, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(temp_solvent[, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dv">2</span>, fac_to_num)</span>
<span id="cb122-12"><a href="factorial.html#cb122-12"></a>temp_reagent[, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(temp_reagent[, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dv">2</span>, fac_to_num)</span>
<span id="cb122-13"><a href="factorial.html#cb122-13"></a>time_solvent[, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(time_solvent[, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dv">2</span>, fac_to_num)</span>
<span id="cb122-14"><a href="factorial.html#cb122-14"></a>time_reagent[, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(time_reagent[, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dv">2</span>, fac_to_num)</span>
<span id="cb122-15"><a href="factorial.html#cb122-15"></a>solvent_reagent[, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(solvent_reagent[, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dv">2</span>, fac_to_num)</span>
<span id="cb122-16"><a href="factorial.html#cb122-16"></a></span>
<span id="cb122-17"><a href="factorial.html#cb122-17"></a><span class="co">## interaction plots</span></span>
<span id="cb122-18"><a href="factorial.html#cb122-18"></a>plotmin &lt;-<span class="st"> </span><span class="kw">min</span>(temp_time<span class="op">$</span>yield, temp_solvent<span class="op">$</span>yield, temp_reagent<span class="op">$</span>yield,</span>
<span id="cb122-19"><a href="factorial.html#cb122-19"></a>               time_solvent<span class="op">$</span>yield, time_reagent<span class="op">$</span>yield, solvent_reagent<span class="op">$</span>yield)</span>
<span id="cb122-20"><a href="factorial.html#cb122-20"></a>plotmax &lt;-<span class="st"> </span><span class="kw">max</span>(temp_time<span class="op">$</span>yield, temp_solvent<span class="op">$</span>yield, temp_reagent<span class="op">$</span>yield,</span>
<span id="cb122-21"><a href="factorial.html#cb122-21"></a>               time_solvent<span class="op">$</span>yield, time_reagent<span class="op">$</span>yield, solvent_reagent<span class="op">$</span>yield)</span>
<span id="cb122-22"><a href="factorial.html#cb122-22"></a><span class="kw">par</span>(<span class="dt">cex =</span> <span class="dv">2</span>)</span>
<span id="cb122-23"><a href="factorial.html#cb122-23"></a><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>), <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>), <span class="dt">respect =</span> T)</span>
<span id="cb122-24"><a href="factorial.html#cb122-24"></a></span>
<span id="cb122-25"><a href="factorial.html#cb122-25"></a><span class="kw">plot</span>(yield <span class="op">~</span><span class="st"> </span>temp, <span class="dt">data =</span> temp_time, <span class="dt">ylim =</span> <span class="kw">c</span>(plotmin, plotmax)) <span class="co"># temp x time</span></span>
<span id="cb122-26"><a href="factorial.html#cb122-26"></a><span class="kw">lines</span>(temp_time[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span>], temp_time[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">3</span>], <span class="dt">lty =</span> <span class="dv">1</span>)</span>
<span id="cb122-27"><a href="factorial.html#cb122-27"></a><span class="kw">lines</span>(temp_time[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span>], temp_time[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">3</span>], <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb122-28"><a href="factorial.html#cb122-28"></a><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Time = low&quot;</span>, <span class="st">&quot;Time = high&quot;</span>), <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">cex =</span> <span class="fl">.75</span>)</span>
<span id="cb122-29"><a href="factorial.html#cb122-29"></a></span>
<span id="cb122-30"><a href="factorial.html#cb122-30"></a><span class="kw">plot</span>(yield <span class="op">~</span><span class="st"> </span>temp, <span class="dt">data =</span> temp_solvent, <span class="dt">ylim =</span> <span class="kw">c</span>(plotmin, plotmax)) <span class="co"># temp x solvent</span></span>
<span id="cb122-31"><a href="factorial.html#cb122-31"></a><span class="kw">lines</span>(temp_solvent[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span>], temp_solvent[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">3</span>], <span class="dt">lty =</span> <span class="dv">1</span>)</span>
<span id="cb122-32"><a href="factorial.html#cb122-32"></a><span class="kw">lines</span>(temp_solvent[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span>], temp_solvent[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">3</span>], <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb122-33"><a href="factorial.html#cb122-33"></a><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Solvent = low&quot;</span>, <span class="st">&quot;Solvent = high&quot;</span>), <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">cex =</span> <span class="fl">.75</span>)</span>
<span id="cb122-34"><a href="factorial.html#cb122-34"></a></span>
<span id="cb122-35"><a href="factorial.html#cb122-35"></a><span class="kw">plot</span>(yield <span class="op">~</span><span class="st"> </span>temp, <span class="dt">data =</span> temp_reagent, <span class="dt">ylim =</span> <span class="kw">c</span>(plotmin, plotmax)) <span class="co"># temp x reagent</span></span>
<span id="cb122-36"><a href="factorial.html#cb122-36"></a><span class="kw">lines</span>(temp_reagent[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span>], temp_reagent[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">3</span>], <span class="dt">lty =</span> <span class="dv">1</span>)</span>
<span id="cb122-37"><a href="factorial.html#cb122-37"></a><span class="kw">lines</span>(temp_reagent[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span>], temp_reagent[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">3</span>], <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb122-38"><a href="factorial.html#cb122-38"></a><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Reagent = low&quot;</span>, <span class="st">&quot;Reagent = high&quot;</span>), <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">cex =</span> <span class="fl">.75</span>)</span>
<span id="cb122-39"><a href="factorial.html#cb122-39"></a></span>
<span id="cb122-40"><a href="factorial.html#cb122-40"></a><span class="kw">plot</span>(yield <span class="op">~</span><span class="st"> </span>time, <span class="dt">data =</span> time_solvent, <span class="dt">ylim =</span> <span class="kw">c</span>(plotmin, plotmax)) <span class="co"># time x solvent</span></span>
<span id="cb122-41"><a href="factorial.html#cb122-41"></a><span class="kw">lines</span>(time_solvent[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span>], time_solvent[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">3</span>], <span class="dt">lty =</span> <span class="dv">1</span>)</span>
<span id="cb122-42"><a href="factorial.html#cb122-42"></a><span class="kw">lines</span>(time_solvent[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span>], time_solvent[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">3</span>], <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb122-43"><a href="factorial.html#cb122-43"></a><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Solvent = low&quot;</span>, <span class="st">&quot;Solvent = high&quot;</span>), <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">cex =</span> <span class="fl">.75</span>)</span>
<span id="cb122-44"><a href="factorial.html#cb122-44"></a></span>
<span id="cb122-45"><a href="factorial.html#cb122-45"></a><span class="kw">plot</span>(yield <span class="op">~</span><span class="st"> </span>time, <span class="dt">data =</span> time_reagent, <span class="dt">ylim =</span> <span class="kw">c</span>(plotmin, plotmax)) <span class="co"># time x reagent</span></span>
<span id="cb122-46"><a href="factorial.html#cb122-46"></a><span class="kw">lines</span>(time_reagent[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span>], time_reagent[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">3</span>], <span class="dt">lty =</span> <span class="dv">1</span>)</span>
<span id="cb122-47"><a href="factorial.html#cb122-47"></a><span class="kw">lines</span>(time_reagent[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span>], time_reagent[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">3</span>], <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb122-48"><a href="factorial.html#cb122-48"></a><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Reagent = low&quot;</span>, <span class="st">&quot;Reagent = high&quot;</span>), <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">cex =</span> <span class="fl">.75</span>)</span>
<span id="cb122-49"><a href="factorial.html#cb122-49"></a></span>
<span id="cb122-50"><a href="factorial.html#cb122-50"></a><span class="kw">plot</span>(yield <span class="op">~</span><span class="st"> </span>solvent, <span class="dt">data =</span> solvent_reagent, <span class="dt">ylim =</span> <span class="kw">c</span>(plotmin, plotmax)) <span class="co"># solvent x reagent</span></span>
<span id="cb122-51"><a href="factorial.html#cb122-51"></a><span class="kw">lines</span>(solvent_reagent[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span>], solvent_reagent[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">3</span>], <span class="dt">lty =</span> <span class="dv">1</span>)</span>
<span id="cb122-52"><a href="factorial.html#cb122-52"></a><span class="kw">lines</span>(solvent_reagent[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">1</span>], solvent_reagent[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">3</span>], <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb122-53"><a href="factorial.html#cb122-53"></a><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Reagent = low&quot;</span>, <span class="st">&quot;Reagent = high&quot;</span>), <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">cex =</span> <span class="fl">.75</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:desilylation-2fi-plots"></span>
<img src="bookdown_math3014-6027_files/figure-html/desilylation-2fi-plots-1.png" alt="Desilylation experiment: two-factor interaction plots" width="672" />
<p class="caption">
Figure 4.2: Desilylation experiment: two-factor interaction plots
</p>
</div>
<p>Parallel lines in an interaction plot indicate no interaction</p>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Owen2001">
<p>Owen, M. R., Luscombe, C., Lai, L., et al. (2001) Efficiency by design: Optimisation in process research. <em>Organic Process Research and Development</em>, <strong>5</strong>, 308–323.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="24">
<li id="fn24"><p>Desilylation is a process of removing silyl, SiH<span class="math inline">\(_3\)</span> a silicon hydride, from a compound.<a href="factorial.html#fnref24" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="blocking.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="block-factorial.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown_math3014-6027.pdf", "bookdown_math3014-6027.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
