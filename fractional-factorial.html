<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Fractional factorial designs | MATH3014-6027 Design (and Analysis) of Experiments</title>
  <meta name="description" content="Lecture notes for the modules MATH3014 and MATH6027 at the University of Southampton" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Fractional factorial designs | MATH3014-6027 Design (and Analysis) of Experiments" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Lecture notes for the modules MATH3014 and MATH6027 at the University of Southampton" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Fractional factorial designs | MATH3014-6027 Design (and Analysis) of Experiments" />
  
  <meta name="twitter:description" content="Lecture notes for the modules MATH3014 and MATH6027 at the University of Southampton" />
  

<meta name="author" content="Dave Woods" />


<meta name="date" content="2022-05-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="block-factorial.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MATH3014-6027</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Motivation, introduction and revision</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#motivation"><i class="fa fa-check"></i><b>1.1</b> Motivation</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#aims-of-experimentation-and-some-examples"><i class="fa fa-check"></i><b>1.2</b> Aims of experimentation and some examples</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#some-definitions"><i class="fa fa-check"></i><b>1.3</b> Some definitions</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#principles"><i class="fa fa-check"></i><b>1.4</b> Principles of experimentation</a><ul>
<li class="chapter" data-level="1.4.1" data-path="intro.html"><a href="intro.html#replication"><i class="fa fa-check"></i><b>1.4.1</b> Replication</a></li>
<li class="chapter" data-level="1.4.2" data-path="intro.html"><a href="intro.html#randomisation"><i class="fa fa-check"></i><b>1.4.2</b> Randomisation</a></li>
<li class="chapter" data-level="1.4.3" data-path="intro.html"><a href="intro.html#intro-blocking"><i class="fa fa-check"></i><b>1.4.3</b> Stratification (or blocking)</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#lin-model-rev"><i class="fa fa-check"></i><b>1.5</b> Revision on the linear model</a><ul>
<li class="chapter" data-level="1.5.1" data-path="intro.html"><a href="intro.html#variance-of-a-predictionfitted-value"><i class="fa fa-check"></i><b>1.5.1</b> Variance of a Prediction/Fitted Value</a></li>
<li class="chapter" data-level="1.5.2" data-path="intro.html"><a href="intro.html#anova-revision"><i class="fa fa-check"></i><b>1.5.2</b> Analysis of Variance and R<span class="math inline">\(^{2}\)</span> as Model Comparison</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>1.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="crd.html"><a href="crd.html"><i class="fa fa-check"></i><b>2</b> Completely randomised designs</a><ul>
<li class="chapter" data-level="2.1" data-path="crd.html"><a href="crd.html#a-unit-treatment-linear-model"><i class="fa fa-check"></i><b>2.1</b> A unit-treatment linear model</a></li>
<li class="chapter" data-level="2.2" data-path="crd.html"><a href="crd.html#the-partitioned-linear-model"><i class="fa fa-check"></i><b>2.2</b> The partitioned linear model</a></li>
<li class="chapter" data-level="2.3" data-path="crd.html"><a href="crd.html#reduced-normal-equations-for-the-crd"><i class="fa fa-check"></i><b>2.3</b> Reduced normal equations for the CRD</a></li>
<li class="chapter" data-level="2.4" data-path="crd.html"><a href="crd.html#contrasts"><i class="fa fa-check"></i><b>2.4</b> Contrasts</a></li>
<li class="chapter" data-level="2.5" data-path="crd.html"><a href="crd.html#contrast-crd"><i class="fa fa-check"></i><b>2.5</b> Treatment contrast estimators in the CRD</a></li>
<li class="chapter" data-level="2.6" data-path="crd.html"><a href="crd.html#r-crd"><i class="fa fa-check"></i><b>2.6</b> Analysing CRDs in R</a></li>
<li class="chapter" data-level="2.7" data-path="crd.html"><a href="crd.html#multiple-comp"><i class="fa fa-check"></i><b>2.7</b> Multiple comparisons</a></li>
<li class="chapter" data-level="2.8" data-path="crd.html"><a href="crd.html#impact-of-design-choices-on-estimation"><i class="fa fa-check"></i><b>2.8</b> Impact of design choices on estimation</a><ul>
<li class="chapter" data-level="2.8.1" data-path="crd.html"><a href="crd.html#crd-opt-all"><i class="fa fa-check"></i><b>2.8.1</b> Optimal treatment allocation</a></li>
<li class="chapter" data-level="2.8.2" data-path="crd.html"><a href="crd.html#crd-size"><i class="fa fa-check"></i><b>2.8.2</b> Overall size of the experiment</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="crd.html"><a href="crd.html#exercises-1"><i class="fa fa-check"></i><b>2.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="blocking.html"><a href="blocking.html"><i class="fa fa-check"></i><b>3</b> Blocking</a><ul>
<li class="chapter" data-level="3.1" data-path="blocking.html"><a href="blocking.html#unit-block-treatment-model"><i class="fa fa-check"></i><b>3.1</b> Unit-block-treatment model</a></li>
<li class="chapter" data-level="3.2" data-path="blocking.html"><a href="blocking.html#normal-equations"><i class="fa fa-check"></i><b>3.2</b> Normal equations</a></li>
<li class="chapter" data-level="3.3" data-path="blocking.html"><a href="blocking.html#block-anova"><i class="fa fa-check"></i><b>3.3</b> Analysis of variance</a></li>
<li class="chapter" data-level="3.4" data-path="blocking.html"><a href="blocking.html#rcdb"><i class="fa fa-check"></i><b>3.4</b> Randomised complete block designs</a></li>
<li class="chapter" data-level="3.5" data-path="blocking.html"><a href="blocking.html#blocks-orthogonal"><i class="fa fa-check"></i><b>3.5</b> Orthogonal blocking</a></li>
<li class="chapter" data-level="3.6" data-path="blocking.html"><a href="blocking.html#sec-bibd"><i class="fa fa-check"></i><b>3.6</b> Balanced incomplete block designs</a><ul>
<li class="chapter" data-level="3.6.1" data-path="blocking.html"><a href="blocking.html#construction-of-bibds"><i class="fa fa-check"></i><b>3.6.1</b> Construction of BIBDs</a></li>
<li class="chapter" data-level="3.6.2" data-path="blocking.html"><a href="blocking.html#reduced-normal-equations"><i class="fa fa-check"></i><b>3.6.2</b> Reduced normal equations</a></li>
<li class="chapter" data-level="3.6.3" data-path="blocking.html"><a href="blocking.html#estimation-and-inference"><i class="fa fa-check"></i><b>3.6.3</b> Estimation and inference</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="blocking.html"><a href="blocking.html#exercises-2"><i class="fa fa-check"></i><b>3.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="factorial.html"><a href="factorial.html"><i class="fa fa-check"></i><b>4</b> Factorial experiments</a><ul>
<li class="chapter" data-level="4.1" data-path="factorial.html"><a href="factorial.html#factorial-contrasts"><i class="fa fa-check"></i><b>4.1</b> Factorial contrasts</a><ul>
<li class="chapter" data-level="4.1.1" data-path="factorial.html"><a href="factorial.html#main-effects"><i class="fa fa-check"></i><b>4.1.1</b> Main effects</a></li>
<li class="chapter" data-level="4.1.2" data-path="factorial.html"><a href="factorial.html#interactions"><i class="fa fa-check"></i><b>4.1.2</b> Interactions</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="factorial.html"><a href="factorial.html#fact-principles"><i class="fa fa-check"></i><b>4.2</b> Three principles for factorial effects</a></li>
<li class="chapter" data-level="4.3" data-path="factorial.html"><a href="factorial.html#unreplicated-normal-plots"><i class="fa fa-check"></i><b>4.3</b> Normal effect plots for unreplicated factorial designs</a><ul>
<li class="chapter" data-level="4.3.1" data-path="factorial.html"><a href="factorial.html#lenths-method-for-approximate-hypothesis-testing"><i class="fa fa-check"></i><b>4.3.1</b> Lenth’s method for approximate hypothesis testing</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="factorial.html"><a href="factorial.html#fac-reg"><i class="fa fa-check"></i><b>4.4</b> Regression modelling for factorial experiments</a><ul>
<li class="chapter" data-level="4.4.1" data-path="factorial.html"><a href="factorial.html#anova-for-factorial-experiments"><i class="fa fa-check"></i><b>4.4.1</b> ANOVA for factorial experiments</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="factorial.html"><a href="factorial.html#exercises-3"><i class="fa fa-check"></i><b>4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="block-factorial.html"><a href="block-factorial.html"><i class="fa fa-check"></i><b>5</b> Blocking in factorial designs</a><ul>
<li class="chapter" data-level="5.1" data-path="block-factorial.html"><a href="block-factorial.html#two-examples"><i class="fa fa-check"></i><b>5.1</b> Two examples</a></li>
<li class="chapter" data-level="5.2" data-path="block-factorial.html"><a href="block-factorial.html#general-method-of-constructing-a-confounded-block-design"><i class="fa fa-check"></i><b>5.2</b> General method of constructing a confounded block design</a></li>
<li class="chapter" data-level="5.3" data-path="block-factorial.html"><a href="block-factorial.html#analysis-of-a-confounded-factorial-design"><i class="fa fa-check"></i><b>5.3</b> Analysis of a confounded factorial design</a></li>
<li class="chapter" data-level="5.4" data-path="block-factorial.html"><a href="block-factorial.html#exercises-4"><i class="fa fa-check"></i><b>5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="fractional-factorial.html"><a href="fractional-factorial.html"><i class="fa fa-check"></i><b>6</b> Fractional factorial designs</a><ul>
<li class="chapter" data-level="6.1" data-path="fractional-factorial.html"><a href="fractional-factorial.html#est-alias"><i class="fa fa-check"></i><b>6.1</b> Estimability and aliasing</a></li>
<li class="chapter" data-level="6.2" data-path="fractional-factorial.html"><a href="fractional-factorial.html#general-method-for-choosing-a-fractional-factorial-design"><i class="fa fa-check"></i><b>6.2</b> General method for choosing a fractional factorial design</a></li>
<li class="chapter" data-level="6.3" data-path="fractional-factorial.html"><a href="fractional-factorial.html#resolution-and-aberration"><i class="fa fa-check"></i><b>6.3</b> Resolution and aberration</a></li>
<li class="chapter" data-level="6.4" data-path="fractional-factorial.html"><a href="fractional-factorial.html#frac-anal"><i class="fa fa-check"></i><b>6.4</b> Analysis of fractional factorial designs</a></li>
<li class="chapter" data-level="6.5" data-path="fractional-factorial.html"><a href="fractional-factorial.html#blocking-fractional-fractorial-designs"><i class="fa fa-check"></i><b>6.5</b> Blocking fractional fractorial designs</a></li>
<li class="chapter" data-level="6.6" data-path="fractional-factorial.html"><a href="fractional-factorial.html#exercises-5"><i class="fa fa-check"></i><b>6.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MATH3014-6027 Design (and Analysis) of Experiments</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="fractional-factorial" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Fractional factorial designs</h1>
<p>The factorial designs we studied in Chapters <a href="factorial.html#factorial">4</a> and <a href="factorial.html#factorial">4</a> can involve a large number of treatments, for even a moderate number of factors (Table <a href="fractional-factorial.html#tab:size-of-factorial">6.1</a>).</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="fractional-factorial.html#cb193-1"></a>size &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>, <span class="dv">2</span><span class="op">^</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>))</span>
<span id="cb193-2"><a href="fractional-factorial.html#cb193-2"></a>knitr<span class="op">::</span><span class="kw">kable</span>(size, <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;No. factors&quot;</span>, <span class="st">&quot;No. of trts&quot;</span>), <span class="dt">caption =</span> <span class="st">&quot;Number of treatments in a $2^f$ factorial designs for different numbers, $f$, of factors.&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:size-of-factorial">Table 6.1: </span>Number of treatments in a <span class="math inline">\(2^f\)</span> factorial designs for different numbers, <span class="math inline">\(f\)</span>, of factors.</caption>
<thead>
<tr class="header">
<th align="right">No. factors</th>
<th align="right">No. of trts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">16</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">32</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">64</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">128</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">256</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">512</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">1024</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">2048</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="right">4096</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="right">8192</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">16384</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">32768</td>
</tr>
</tbody>
</table>
<p>For larger numbers of factors, resource constraints may mean it is not possible to run an experiment using all <span class="math inline">\(2^f\)</span> treatments. Also, many degrees of freedom in these experiments are used to estimate high-order interactions. For example, in a <span class="math inline">\(2^5\)</span> experiment, 16 degrees of freedom are used to estimate three-factor and higher interactions, half the size of the experiment. The principles of effect hierarchy and sparsity (Section <a href="factorial.html#fact-principles">4.2</a>) suggest this is probably wasteful.</p>
<p>We can select smaller experiments by using a subset, or <strong>fraction</strong> of the treatments of size <span class="math inline">\(2^{f-q}\)</span>:</p>
<ol style="list-style-type: lower-alpha">
<li><p>divide the treatments in subsets by confounding <span class="math inline">\(q\)</span> factorial effects (and their products), as in blocking;</p></li>
<li><p>only use <strong>one</strong> of the subsets in the experiment.</p></li>
</ol>
<div class="example">
<p><span id="exm:spring-experiment" class="example"><strong>Example 6.1  </strong></span>Spring experiment <span class="citation">(Wu and Hamada, <a href="#ref-WH2009" role="doc-biblioref">2009</a>, ch. 5)</span></p>
<p>Consider an industrial experiment to investigate the effect of <span class="math inline">\(f=5\)</span> factors on the unloaded height of a spring produced using a heat treatment. The five factors are described in Table <a href="fractional-factorial.html#tab:spring-factors">6.2</a>.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="fractional-factorial.html#cb194-1"></a>factor.name &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Quench temperature (F)&quot;</span>, <span class="st">&quot;Heat temperature (F)&quot;</span>, <span class="st">&quot;Heating time (s)&quot;</span>, </span>
<span id="cb194-2"><a href="fractional-factorial.html#cb194-2"></a>                 <span class="st">&quot;Transfer time (s)&quot;</span>, <span class="st">&quot;Hold-down time (s)&quot;</span>)</span>
<span id="cb194-3"><a href="fractional-factorial.html#cb194-3"></a>low.level &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;130-150&quot;</span>, <span class="dv">1840</span>, <span class="dv">23</span>, <span class="dv">10</span>, <span class="dv">2</span>)</span>
<span id="cb194-4"><a href="fractional-factorial.html#cb194-4"></a>high.level &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;150-170&quot;</span>, <span class="dv">1880</span>, <span class="dv">25</span>, <span class="dv">12</span>, <span class="dv">3</span>)</span>
<span id="cb194-5"><a href="fractional-factorial.html#cb194-5"></a>spring.factors &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">factor =</span> factor.name, <span class="dt">low =</span> low.level, <span class="dt">high =</span> high.level)</span>
<span id="cb194-6"><a href="fractional-factorial.html#cb194-6"></a><span class="kw">row.names</span>(spring.factors) &lt;-<span class="st"> </span>LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb194-7"><a href="fractional-factorial.html#cb194-7"></a>knitr<span class="op">::</span><span class="kw">kable</span>(spring.factors, <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;Factor&quot;</span>, <span class="st">&quot;Low level&quot;</span>, <span class="st">&quot;High level&quot;</span>), </span>
<span id="cb194-8"><a href="fractional-factorial.html#cb194-8"></a>             <span class="dt">align =</span> <span class="kw">c</span>(<span class="st">&quot;l&quot;</span>, <span class="st">&quot;r&quot;</span>, <span class="st">&quot;r&quot;</span>), <span class="dt">caption =</span> <span class="st">&quot;Spring experiment: factors and levels&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:spring-factors">Table 6.2: </span>Spring experiment: factors and levels</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Factor</th>
<th align="right">Low level</th>
<th align="right">High level</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="left">Quench temperature (F)</td>
<td align="right">130-150</td>
<td align="right">150-170</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="left">Heat temperature (F)</td>
<td align="right">1840</td>
<td align="right">1880</td>
</tr>
<tr class="odd">
<td align="left">C</td>
<td align="left">Heating time (s)</td>
<td align="right">23</td>
<td align="right">25</td>
</tr>
<tr class="even">
<td align="left">D</td>
<td align="left">Transfer time (s)</td>
<td align="right">10</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td align="left">E</td>
<td align="left">Hold-down time (s)</td>
<td align="right">2</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<p>Enough experimental units were available to perform <span class="math inline">\(n=16\)</span> runs, which is one-half of the total number of treatments. We refer to this type of design as a <strong>one-half fractional replicate</strong> of the full factorial design, or a <strong><span class="math inline">\(2^{5-1}\)</span> fractional factorial design</strong><a href="#fn37" class="footnote-ref" id="fnref37"><sup>37</sup></a>.</p>
<p>The design was constructed by confounding <span class="math inline">\(q=1\)</span> factorial effects with blocks, the interaction <span class="math inline">\(BCDE\)</span> was chosen, and running just one of the two resulting subsets, see Table <a href="fractional-factorial.html#tab:spring-data">6.3</a> where <code>FrF2</code> is used to generate the design.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="fractional-factorial.html#cb195-1"></a>spring &lt;-<span class="st"> </span>FrF2<span class="op">::</span><span class="kw">FrF2</span>(<span class="dt">nruns =</span> <span class="dv">16</span>, <span class="dt">nfactors =</span> <span class="dv">5</span>, <span class="dt">generators =</span> <span class="st">&quot;BCD&quot;</span>, <span class="dt">randomize =</span> F)</span>
<span id="cb195-2"><a href="fractional-factorial.html#cb195-2"></a>spring<span class="op">$</span>height &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">7.54</span>, <span class="fl">7.20</span>, <span class="fl">7.69</span>, <span class="fl">7.63</span>, <span class="fl">7.94</span>, <span class="fl">7.40</span>, <span class="fl">7.95</span>, <span class="fl">7.62</span>, <span class="fl">7.52</span>, <span class="fl">7.52</span>, </span>
<span id="cb195-3"><a href="fractional-factorial.html#cb195-3"></a>                   <span class="fl">7.63</span>, <span class="fl">7.65</span>, <span class="fl">7.79</span>, <span class="fl">7.29</span>, <span class="fl">8.07</span>, <span class="fl">7.73</span>)</span>
<span id="cb195-4"><a href="fractional-factorial.html#cb195-4"></a>knitr<span class="op">::</span><span class="kw">kable</span>(spring, <span class="dt">caption =</span> <span class="st">&quot;Spring experiment: 16 run design.&quot;</span>, <span class="dt">align =</span> <span class="kw">rep</span>(<span class="st">&quot;r&quot;</span>, <span class="dv">6</span>))</span></code></pre></div>
<table>
<caption><span id="tab:spring-data">Table 6.3: </span>Spring experiment: 16 run design.</caption>
<thead>
<tr class="header">
<th align="right">A</th>
<th align="right">B</th>
<th align="right">C</th>
<th align="right">D</th>
<th align="right">E</th>
<th align="right">height</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">7.54</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">7.20</td>
</tr>
<tr class="odd">
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">7.69</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">7.63</td>
</tr>
<tr class="odd">
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">7.94</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">7.40</td>
</tr>
<tr class="odd">
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">7.95</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">7.62</td>
</tr>
<tr class="odd">
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">7.52</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">7.52</td>
</tr>
<tr class="odd">
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">7.63</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">7.65</td>
</tr>
<tr class="odd">
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">7.79</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">7.29</td>
</tr>
<tr class="odd">
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">8.07</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">7.73</td>
</tr>
</tbody>
</table>
<p>Clearly, using a subset of the treatments, we will no longer be able to estimate all the factorial effects (we have insufficient degrees of freedom). We have confounded the interaction <span class="math inline">\(BCDE\)</span>, and hence clearly the contrast coefficients for this effect will be constant in our design. We say the interaction <span class="math inline">\(BCDE\)</span> is <strong>aliased</strong> with the mean, and we write this as <span class="math inline">\(I = BCDE\)</span>. This expression is called the <strong>defining relation</strong>, as knowledge of which factorial effects are aliased with the mean completely define the fractional factorial.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="fractional-factorial.html#cb196-1"></a>fac_to_numeric &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">as.numeric</span>(<span class="kw">as.character</span>(x))</span>
<span id="cb196-2"><a href="fractional-factorial.html#cb196-2"></a>BCDE &lt;-<span class="st"> </span><span class="kw">fac_to_numeric</span>(spring<span class="op">$</span>B) <span class="op">*</span><span class="st"> </span><span class="kw">fac_to_numeric</span>(spring<span class="op">$</span>C) <span class="op">*</span><span class="st"> </span></span>
<span id="cb196-3"><a href="fractional-factorial.html#cb196-3"></a><span class="st">  </span><span class="kw">fac_to_numeric</span>(spring<span class="op">$</span>D) <span class="op">*</span><span class="st"> </span><span class="kw">fac_to_numeric</span>(spring<span class="op">$</span>E) </span>
<span id="cb196-4"><a href="fractional-factorial.html#cb196-4"></a>BCDE</span></code></pre></div>
<pre><code>##  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</code></pre>
<p>This removes one factorial effect from consideration, but we are still short on degrees of freedom. What are the other consequences of using a fractional factorial design?</p>
<p>As the contrast coefficients for the interaction <span class="math inline">\(BCDE\)</span> are constant, the contrast coefficients for any pairs of factorial effects whose (hadamard) product form <span class="math inline">\(BCDE\)</span> will be equal. For example, the contrast coefficient vectors for interactions <span class="math inline">\(BC\)</span> and <span class="math inline">\(DE\)</span> will be equal, as will the vectors for the main effect <span class="math inline">\(B\)</span> and the interaction <span class="math inline">\(CDE\)</span>, and so on.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="fractional-factorial.html#cb198-1"></a>BC &lt;-<span class="st"> </span><span class="kw">fac_to_numeric</span>(spring<span class="op">$</span>B) <span class="op">*</span><span class="st"> </span><span class="kw">fac_to_numeric</span>(spring<span class="op">$</span>C)</span>
<span id="cb198-2"><a href="fractional-factorial.html#cb198-2"></a>DE &lt;-<span class="st"> </span><span class="kw">fac_to_numeric</span>(spring<span class="op">$</span>D) <span class="op">*</span><span class="st"> </span><span class="kw">fac_to_numeric</span>(spring<span class="op">$</span>E)</span>
<span id="cb198-3"><a href="fractional-factorial.html#cb198-3"></a>BC</span>
<span id="cb198-4"><a href="fractional-factorial.html#cb198-4"></a>DE</span>
<span id="cb198-5"><a href="fractional-factorial.html#cb198-5"></a><span class="kw">all.equal</span>(BC, DE)</span></code></pre></div>
<pre><code>##  [1]  1  1 -1 -1 -1 -1  1  1  1  1 -1 -1 -1 -1  1  1
##  [1]  1  1 -1 -1 -1 -1  1  1  1  1 -1 -1 -1 -1  1  1
## [1] TRUE</code></pre>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="fractional-factorial.html#cb200-1"></a>B &lt;-<span class="st"> </span><span class="kw">fac_to_numeric</span>(spring<span class="op">$</span>B)</span>
<span id="cb200-2"><a href="fractional-factorial.html#cb200-2"></a>CDE &lt;-<span class="st"> </span><span class="kw">fac_to_numeric</span>(spring<span class="op">$</span>C) <span class="op">*</span><span class="st"> </span><span class="kw">fac_to_numeric</span>(spring<span class="op">$</span>D) <span class="op">*</span><span class="st"> </span><span class="kw">fac_to_numeric</span>(spring<span class="op">$</span>E)</span>
<span id="cb200-3"><a href="fractional-factorial.html#cb200-3"></a>B</span>
<span id="cb200-4"><a href="fractional-factorial.html#cb200-4"></a>CDE</span>
<span id="cb200-5"><a href="fractional-factorial.html#cb200-5"></a><span class="kw">all.equal</span>(B, CDE)</span></code></pre></div>
<pre><code>##  [1] -1 -1  1  1 -1 -1  1  1 -1 -1  1  1 -1 -1  1  1
##  [1] -1 -1  1  1 -1 -1  1  1 -1 -1  1  1 -1 -1  1  1
## [1] TRUE</code></pre>
<p>We say these factorial effects are <strong>aliased</strong>. From the defining relation, we can derive the complete <strong>aliasing scheme</strong> for a fractional factorial design. For the example,</p>
<p><span class="math display">\[\begin{align}
I &amp; = BCDE \\
A &amp; = ABCDE \\
B &amp; = CDE \\
C &amp; = BDE \\
D &amp; = BCE \\
E &amp; = BCD \\
AB &amp; = ACDE \\
AC &amp; = ABDE \\
AD &amp; = ABCE \\
AE &amp; = ABCD \\
BC &amp; = DE \\
BD &amp; = CE \\
BE &amp; = CD \\
ABC &amp; = ADE \\
ABD &amp; = ACE \\
ABE &amp; = ACD \\
\end{align}\]</span></p>
<p>The aliasing scheme contains <span class="math inline">\(2^{f-q} = 2^{5-1} = 16\)</span> “strings”, each one containing <span class="math inline">\(2^q = 2^1 = 2\)</span> “words”. The design is not capable to distinguishing between factorial effects in the same alias string.</p>
<p>We can also generate this information using the <code>aliases</code> function from <code>FrF2</code>.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="fractional-factorial.html#cb202-1"></a>spring.lm &lt;-<span class="st"> </span><span class="kw">lm</span>(height <span class="op">~</span><span class="st"> </span>(.)<span class="op">^</span><span class="dv">5</span>, <span class="dt">data =</span> spring)</span>
<span id="cb202-2"><a href="fractional-factorial.html#cb202-2"></a>FrF2<span class="op">::</span><span class="kw">aliases</span>(spring.lm)</span></code></pre></div>
<pre><code>##               
##  A = A:B:C:D:E
##  B = C:D:E    
##  C = B:D:E    
##  D = B:C:E    
##  E = B:C:D    
##  A:B = A:C:D:E
##  A:C = A:B:D:E
##  A:D = A:B:C:E
##  A:E = A:B:C:D
##  B:C = D:E    
##  B:D = C:E    
##  B:E = C:D    
##  A:B:C = A:D:E
##  A:B:D = A:C:E
##  A:B:E = A:C:D</code></pre>
</div>
<div class="definition">
<p><span id="def:regular-fraction" class="definition"><strong>Definition 6.1  </strong></span>A <strong>regular <span class="math inline">\(2^{f-q}\)</span>fractional factorial design</strong> is constructed by aliasing <span class="math inline">\(2^q-1\)</span> factorial effects with the mean; <span class="math inline">\(q\)</span> of these effects can be chosen independently, the others are formed via the hadamard product of the contrast coefficients for the <span class="math inline">\(q\)</span> effects,</p>
</div>
<p>How do we chose the factorial effects to alias with the mean? As with blocking, we tend to choose higher-order effects, taking care when <span class="math inline">\(q&gt;1\)</span> not to inadvertently alias together lower-order effects (see later examples).</p>
<p>For Example <a href="fractional-factorial.html#exm:spring-experiment">6.1</a>, a slightly unusual defining relation was chosen. It would be more common to use <span class="math inline">\(I = ABCDE\)</span>, leading to the aliasing scheme:</p>
<p><span class="math display">\[\begin{align}
I &amp; = ABCDE \\
A &amp; = BCDE \\
B &amp; = ACDE \\
C &amp; = ABDE \\
D &amp; = ABCE \\
E &amp; = ABCD \\
AB &amp; = CDE \\
AC &amp; = BDE \\
AD &amp; = BCE \\
AE &amp; = BCD \\
BC &amp; = ADE \\
BD &amp; = ACE \\
BE &amp; = ACD \\
CD &amp; = ABE \\
CE &amp; = ABD \\
DE &amp; = ABC \\
\end{align}\]</span></p>
<p>This defining relation results in main effects being aliased with four-factor interactions and, perhaps more importantly, no pairs of two-factor interactions aliased together. The original design from Example <a href="#exm:Spring-experiment"><strong>??</strong></a> might be used if factor <span class="math inline">\(A\)</span> and its interactions were a priori thought likely to be important (two-factor interactions involving factor <span class="math inline">\(A\)</span> are aliased with four-factor interactions).</p>
<div id="est-alias" class="section level2">
<h2><span class="header-section-number">6.1</span> Estimability and aliasing</h2>
<p>Any factorial effect in an alias string is only estimable <strong>if all other effects in that string are assumed zero</strong><a href="#fn38" class="footnote-ref" id="fnref38"><sup>38</sup></a>. Wd can study this further by introducing the <strong>alias matrix</strong>.</p>
<div class="definition">
<p><span id="def:alias-matrix" class="definition"><strong>Definition 6.2  </strong></span>Assume a linear data generating model</p>
<p><span class="math display">\[
\boldsymbol{y}= X_1\boldsymbol{\beta}_1 + X_2\boldsymbol{\beta}_2 + \boldsymbol{\varepsilon}\,,
\]</span>
where <span class="math inline">\(\boldsymbol{y}\)</span> is an <span class="math inline">\(n\)</span>-vector of responses, <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are <span class="math inline">\(n\times p_1\)</span> and <span class="math inline">\(n\times p_2\)</span> model matrices, respectively, with <span class="math inline">\(\boldsymbol{\beta}_1\)</span> and <span class="math inline">\(\boldsymbol{\beta}_2\)</span> corresponding <span class="math inline">\(p_1\)</span>- and <span class="math inline">\(p_2\)</span>-vectors of parameters and random errors <span class="math inline">\(\varepsilon ~ N(\boldsymbol{0}, I_n\sigma^2)\)</span>.</p>
<p>If the submodel</p>
<p><span class="math display">\[
\boldsymbol{y}= X_1\boldsymbol{\beta}_1 + \boldsymbol{\varepsilon}\,,
\]</span>
is fitted to the response data, then <span class="math inline">\(\hat{\boldsymbol{\beta}}_1 = (X_1^{\mathrm{T}}X_1)^{-1}X_1^{\mathrm{T}}\boldsymbol{y}\)</span>, and
<span class="math display">\[\begin{align*}
E(\hat{\boldsymbol{\beta}}_1) &amp; = \boldsymbol{\beta}_1 + (X_1^{\mathrm{T}}X_1)^{-1}X_1^{\mathrm{T}}X_2\boldsymbol{\beta}_2 \\
&amp; = \boldsymbol{\beta}_1 + A\boldsymbol{\beta}_2\,,
\end{align*}\]</span>
where <span class="math inline">\(A = (X_1^{\mathrm{T}}X_1)^{-1}X_1^{\mathrm{T}}X_2\)</span> is the <strong>alias</strong> matrix.</p>
</div>
<p>We also introduce an alternative definition of estimability.</p>
<div class="definition">
<p><span id="def:alt-estimability" class="definition"><strong>Definition 6.3  </strong></span>A linear combination of parameters <span class="math inline">\(\boldsymbol{c}^{\mathrm{T}}\boldsymbol{\theta}\)</span> is estimable if and only if there exists a linear combination of the responses <span class="math inline">\(\boldsymbol{a}^{\mathrm{T}}\boldsymbol{y}\)</span> such that</p>
<p><span class="math display">\[
E(\boldsymbol{a}^{\mathrm{T}}\boldsymbol{y}) = c^{\mathrm{T}}\boldsymbol{\theta}\,.
\]</span></p>
</div>
<p>Now assume that using a two-level fractional factorial design, we will estimate one factorial effect (equivalently, the corresponding regression coefficient) from each alias string. Then the <span class="math inline">\(A\)</span> matrix will have entries 0, -1 or +1, depending on the defining relation of the fraction. Each regression parameter will be biased by the parameters corresponding to other factorial effects in the alias string. Hence, by Definition <a href="fractional-factorial.html#def:alt-estimability">6.3</a>, each factorial effect is only estimable under the assumption that all other factorial effects in the alias string are zero.</p>
<p>For Example <a href="fractional-factorial.html#exm:spring-experiment">6.1</a> we can generate the alias matrix using the <code>alias</code> function.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="fractional-factorial.html#cb204-1"></a><span class="kw">t</span>(<span class="kw">alias</span>(spring.lm)<span class="op">$</span>Complete)</span></code></pre></div>
<pre><code>##             A1:C1:D1 A1:C1:E1 A1:D1:E1 B1:C1:D1 B1:C1:E1 B1:D1:E1 C1:D1:E1
## (Intercept) 0        0        0        0        0        0        0       
## A1          0        0        0        0        0        0        0       
## B1          0        0        0        0        0        0        1       
## C1          0        0        0        0        0        1        0       
## D1          0        0        0        0        1        0        0       
## E1          0        0        0        1        0        0        0       
## A1:B1       0        0        0        0        0        0        0       
## A1:C1       0        0        0        0        0        0        0       
## A1:D1       0        0        0        0        0        0        0       
## A1:E1       0        0        0        0        0        0        0       
## B1:C1       0        0        0        0        0        0        0       
## B1:D1       0        0        0        0        0        0        0       
## B1:E1       0        0        0        0        0        0        0       
## A1:B1:C1    0        0        1        0        0        0        0       
## A1:B1:D1    0        1        0        0        0        0        0       
## A1:B1:E1    1        0        0        0        0        0        0       
##             A1:B1:C1:D1 A1:B1:C1:E1 A1:B1:D1:E1 A1:C1:D1:E1 B1:C1:D1:E1
## (Intercept) 0           0           0           0           1          
## A1          0           0           0           0           0          
## B1          0           0           0           0           0          
## C1          0           0           0           0           0          
## D1          0           0           0           0           0          
## E1          0           0           0           0           0          
## A1:B1       0           0           0           1           0          
## A1:C1       0           0           1           0           0          
## A1:D1       0           1           0           0           0          
## A1:E1       1           0           0           0           0          
## B1:C1       0           0           0           0           0          
## B1:D1       0           0           0           0           0          
## B1:E1       0           0           0           0           0          
## A1:B1:C1    0           0           0           0           0          
## A1:B1:D1    0           0           0           0           0          
## A1:B1:E1    0           0           0           0           0          
##             A1:B1:C1:D1:E1 C1:D1 C1:E1 D1:E1
## (Intercept) 0              0     0     0    
## A1          1              0     0     0    
## B1          0              0     0     0    
## C1          0              0     0     0    
## D1          0              0     0     0    
## E1          0              0     0     0    
## A1:B1       0              0     0     0    
## A1:C1       0              0     0     0    
## A1:D1       0              0     0     0    
## A1:E1       0              0     0     0    
## B1:C1       0              0     0     1    
## B1:D1       0              0     1     0    
## B1:E1       0              1     0     0    
## A1:B1:C1    0              0     0     0    
## A1:B1:D1    0              0     0     0    
## A1:B1:E1    0              0     0     0</code></pre>
</div>
<div id="general-method-for-choosing-a-fractional-factorial-design" class="section level2">
<h2><span class="header-section-number">6.2</span> General method for choosing a fractional factorial design</h2>
<p>To select a <span class="math inline">\(2^{f-q}\)</span> fractional factorial design:</p>
<ul>
<li>choose <span class="math inline">\(q\)</span> independent factorial contrasts for the <strong>generators</strong>, or <strong>defining words</strong>, <span class="math inline">\(\nu_1,\ldots,n_q\)</span>. Typically, we choose higher-order interactions (due to effect hierarchy):</li>
</ul>
<p><span class="math display">\[
\nu_{1}=\boldsymbol{c}_{1},\ldots,\nu_{q} = \boldsymbol{c}_{q}\,.
\]</span></p>
<ul>
<li>all the hadamard products of <span class="math inline">\(\boldsymbol{c}_{1},\dots,\boldsymbol{c}_{q}\)</span> are also aliased with the mean, and together give the <strong>defining relation</strong>:</li>
</ul>
<p><span class="math display">\[
I = \nu_1 = \ldots = \nu_q = \nu_1\nu_q = \ldots = \nu_1\cdots\nu_q\,. 
\]</span></p>
<ul>
<li>the <strong>aliasing scheme</strong> is a list of the <span class="math inline">\(2^{f-q}\)</span> <strong>alias strings</strong>. Every effect in one string is estimated by the same contrast in the observations:</li>
</ul>
<p><span class="math display">\[
 \begin{array}{ccccccccccccc}
 I &amp; = &amp; \nu_1 &amp; = &amp; \ldots &amp; = &amp; \nu_q &amp; = &amp; \nu_1\nu_q 
 &amp; = &amp; \ldots &amp; = &amp; \nu_1\cdots\nu_q \\
 A &amp; = &amp; A\nu_1 &amp; = &amp; \ldots &amp; = &amp; A\nu_q &amp; = &amp; A\nu_1\nu_q 
 &amp; = &amp; \ldots &amp; = &amp; A\nu_1\cdots\nu_q \\
 B &amp; = &amp; B\nu_1 &amp; = &amp; B\ldots &amp; = &amp; B\nu_q &amp; = &amp; B\nu_1\nu_q 
 &amp; = &amp; \ldots &amp; = &amp; B\nu_1\cdots\nu_q \\
 \vdots \\
 CD &amp; = &amp; CD\nu_1 &amp; = &amp; CD\ldots &amp; = &amp; CD\nu_q &amp; = &amp; CD\nu_1\nu_q 
 &amp; = &amp; CD\ldots &amp; = &amp; CD\nu_1\cdots\nu_q \\
 \vdots
 \end{array}
 \]</span>
All the effects within a single alias string are aliased, and cannot be simultaneously aliased. In fact, the estimation of any effect within an alias string can only proceed if all other effects in the string are assumed zero; otherwise, we can estimate the sum of the effects (see Section <a href="fractional-factorial.html#est-alias">6.1</a>).</p>
<p>To find the treatments in a particular fraction, we simply need to solve a set of equations of the form</p>
<p><span class="math display">\[
\nu_1 = \pm 1, \quad \nu_2 + \pm 1, \quad \ldots \quad \nu_q = \pm 1\,,
\]</span>
with <span class="math inline">\(2^{f-q}\)</span> treatments satisfying the <span class="math inline">\(2^q\)</span> equations corresponding to each choice of <span class="math inline">\(\pm 1\)</span> for each generator.</p>
<div class="example">
<p><span id="exm:frac-illustrative" class="example"><strong>Example 6.2  </strong></span>Consider a <span class="math inline">\(2^{6-2}\)</span> design, with <span class="math inline">\(q=2\)</span> generators <span class="math inline">\(ABCE\)</span> and <span class="math inline">\(BCDF\)</span>. The defining relation is given by</p>
<p><span class="math display">\[
I = ABCE = BCDF = ADEF\,.
\]</span>
The aliasing scheme has <span class="math inline">\(2^{6-2} = 16\)</span> strings, each of which contains <span class="math inline">\(2^2 = 4\)</span> effects or words.</p>
<p><span class="math display">\[
\begin{array}{ccccccc}
I &amp; = &amp; ABCE &amp; = &amp; BCDF &amp; = &amp; ADEF \\
A &amp; = &amp; BCE &amp; = &amp; ABCDF &amp; = &amp; DEF \\
B &amp; = &amp; ACE &amp; = &amp; CDF &amp; = &amp; ABDEF \\
C &amp; = &amp; ABE &amp; = &amp; BDF &amp; = &amp; ACDEF \\
D &amp; = &amp; ABCDE &amp; = &amp; BCF &amp; = &amp; AEF \\
E &amp; = &amp; ABC &amp; = &amp; BCDEF &amp; = &amp; ADF \\
F &amp; = &amp; ABCEF &amp; = &amp; BCD &amp; = &amp; ADE \\
AB &amp; = &amp; CE &amp; = &amp; ACDF &amp; = &amp; BDEF \\
AC &amp; = &amp; BE &amp; = &amp; ABDF &amp; = &amp; CDEF \\
AD &amp; = &amp; BCDE &amp; = &amp; ABCF &amp; = &amp; EF \\
AE &amp; = &amp; BC &amp; = &amp; ABCDEF &amp; = &amp; DF \\
AF &amp; = &amp; BCEF &amp; = &amp; ABCD &amp; = &amp; DE \\
BD &amp; = &amp; ACDE &amp; = &amp; CF &amp; = &amp; ABEF \\
BF &amp; = &amp; ACEF &amp; = &amp; CD &amp; = &amp; ABDE \\
ABD &amp; = &amp; CDE &amp; = &amp; ACF &amp; = &amp; BEF \\
ABF &amp; = &amp; CEF &amp; = &amp; ACD &amp; = &amp; BDE \\
\end{array}
\]</span>
This aliasing scheme can result from any one of the four possible fractions defined by</p>
<p><span class="math display">\[
ABCE = \pm 1\,,\quad BCDF = \pm 1\,.
\]</span>
Each fraction has (essentially) the same statistical properties, except the sign of the biasing coefficients from the alias matrix may be reversed (-1, rather than +1).</p>
<p>For example, the treatments in the fraction may be those <span class="math inline">\(2^{f-q} = 2^{6-2} = 16\)</span> treatments that all have <span class="math inline">\(ABCE = +1\)</span> and <span class="math inline">\(BCDF = +1\)</span>.</p>
</div>
<p>We can also use <code>FrF2</code> to find two-level fractional factorial designs, as we already saw in Example <a href="fractional-factorial.html#exm:spring-experiment">6.1</a>. The <code>generators</code> argument can be used to specify which factorial effects to use as generators. These are specified using what <code>FrF2</code> refers to as the <span class="math inline">\(f-q\)</span> <strong>base factors</strong>. The <span class="math inline">\(q\)</span> generators must specify with which factorial effects in the base factors the <span class="math inline">\(q\)</span> additional factors are aliased.<br />
For Example <a href="fractional-factorial.html#exm:frac-illustrative">6.2</a>, a <span class="math inline">\(2^{6-2}\)</span> design, the base factors are <span class="math inline">\(A, B, C, D\)</span> and from our defining relation we have <span class="math inline">\(E = ABC\)</span> and <span class="math inline">\(F = BCD\)</span>.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="fractional-factorial.html#cb206-1"></a>ff.<span class="dv">2</span>.<span class="fl">6.2</span> &lt;-<span class="st"> </span>FrF2<span class="op">::</span><span class="kw">FrF2</span>(<span class="dt">nruns =</span> <span class="dv">16</span>, <span class="dt">nfactors =</span> <span class="dv">6</span>, <span class="dt">generators =</span> <span class="kw">c</span>(<span class="st">&quot;ABC&quot;</span>, <span class="st">&quot;BCD&quot;</span>), </span>
<span id="cb206-2"><a href="fractional-factorial.html#cb206-2"></a>                       <span class="dt">randomize =</span> F, <span class="dt">alias.info =</span> <span class="dv">3</span>)</span></code></pre></div>
<p>Once <code>FrF2</code> has generated the design, we can interrogate the aliasing (up to three-factor interactions) using <code>design.info</code> (and using the <code>aliases</code> function, see Example <a href="fractional-factorial.html#exm:spring-experiment">6.1</a>).</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="fractional-factorial.html#cb207-1"></a><span class="kw">library</span>(FrF2)</span>
<span id="cb207-2"><a href="fractional-factorial.html#cb207-2"></a><span class="kw">design.info</span>(ff.<span class="dv">2</span>.<span class="fl">6.2</span>)<span class="op">$</span>aliased</span></code></pre></div>
<pre><code>## $legend
## [1] &quot;A=A&quot; &quot;B=B&quot; &quot;C=C&quot; &quot;D=D&quot; &quot;E=E&quot; &quot;F=F&quot;
## 
## $main
## [1] &quot;A=BCE=DEF&quot; &quot;B=ACE=CDF&quot; &quot;C=ABE=BDF&quot; &quot;D=AEF=BCF&quot; &quot;E=ABC=ADF&quot; &quot;F=ADE=BCD&quot;
## 
## $fi2
## [1] &quot;AB=CE&quot;    &quot;AC=BE&quot;    &quot;AD=EF&quot;    &quot;AE=BC=DF&quot; &quot;AF=DE&quot;    &quot;BD=CF&quot;    &quot;BF=CD&quot;   
## 
## $fi3
## [1] &quot;ABD=ACF=BEF=CDE&quot; &quot;ABF=ACD=BDE=CEF&quot;</code></pre>
<p>By default, <code>FrF2</code> chooses the fraction defined by each generator being equal to +1.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="fractional-factorial.html#cb209-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(ff.<span class="dv">2</span>.<span class="fl">6.2</span>, <span class="dt">align =</span> <span class="st">&quot;r&quot;</span>, </span>
<span id="cb209-2"><a href="fractional-factorial.html#cb209-2"></a>             <span class="dt">caption =</span> <span class="st">&quot;Treatments from a $2^{6-2}$ fractional factorial design.&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:FrF2-example-design">Table 6.4: </span>Treatments from a <span class="math inline">\(2^{6-2}\)</span> fractional factorial design.</caption>
<thead>
<tr class="header">
<th align="right">A</th>
<th align="right">B</th>
<th align="right">C</th>
<th align="right">D</th>
<th align="right">E</th>
<th align="right">F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">-1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">-1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
<div id="resolution-and-aberration" class="section level2">
<h2><span class="header-section-number">6.3</span> Resolution and aberration</h2>
<p>Clearly, the numbers of factors involved in the effects in the defining relation play an important role in the properties of the design.</p>
<div class="definition">
<p><span id="def:length" class="definition"><strong>Definition 6.4  </strong></span>Each factorial effect is commonly referred to as a <strong>word</strong>, and the number of factors involved in a factorial effect is its <strong>length</strong>.</p>
</div>
<p>For example, word <span class="math inline">\(ABCD\)</span> has length 4; word <span class="math inline">\(BDE\)</span> has length 3.</p>
<div class="definition">
<p><span id="def:resolution" class="definition"><strong>Definition 6.5  </strong></span>The <strong>resolution</strong> of a <span class="math inline">\(2^{f-q}\)</span> design is the length of the shortest word in the defining relation.</p>
<p>A design having resolution <span class="math inline">\(R\)</span> implies that no effect involving <span class="math inline">\(x\)</span> factors is aliased with effects involving less than <span class="math inline">\(R-x\)</span> factors.</p>
<p>Designs of the following resolution are particularly common.</p>
<ul>
<li><p><em>Resolution III</em>: shortest word of length 3. No main effect is aliased with any other main effect; at least one main effect of aliased with a two-factor interaction.</p></li>
<li><p><em>Resolution IV</em>: shortest word of length 4. No main effect is aliased with any other main effect or any two-factor interaction; at least one pair of two-factor interactions are aliased together.</p></li>
<li><p><em>Resolution V</em>: shortest word of length 5. No main effect or two-factor interaction is aliased with any other main effect or two-factor interaction.</p></li>
</ul>
</div>
<p>For example,</p>
<ul>
<li><p><span class="math inline">\(2^{6-2}\)</span>, <span class="math inline">\(I = ABCD = CDEF = ABEF\)</span>: resolution IV.</p></li>
<li><p><span class="math inline">\(2^{3-1}\)</span>, <span class="math inline">\(I = ABC\)</span>: resolution III.</p></li>
</ul>
<div class="definition">
<p><span id="def:wlp" class="definition"><strong>Definition 6.6  </strong></span>The <em>word length pattern</em> of a <span class="math inline">\(2^{f-q}\)</span> design is given by</p>
<p><span class="math display">\[
W = (w_3, w_4, \ldots, w_f)\,,
\]</span>
where <span class="math inline">\(w_i\)</span> is the number of words of length <span class="math inline">\(i\)</span> in the defining relation.</p>
</div>
<p>For example,</p>
<ul>
<li><p><span class="math inline">\(d_1\)</span>: <span class="math inline">\(2^{7-2}\)</span>, <span class="math inline">\(I = ABCF = ADEG = BCDEFG\)</span></p></li>
<li><p><span class="math inline">\(d_2\)</span>: <span class="math inline">\(2^{7-2}\)</span>, <span class="math inline">\(I = DEFG = ABCDF = ABCEG\)</span></p></li>
</ul>
<p>are both resolution IV designs, but have different word length patterns</p>
<ul>
<li><span class="math inline">\(W(d_1) = (0, 2, 0, 1, 0)\)</span></li>
<li><span class="math inline">\(W(d_2) = (0, 1, 2, 0, 0)\)</span>.</li>
</ul>
<div class="definition">
<p><span id="def:minab" class="definition"><strong>Definition 6.7  </strong></span>For two <span class="math inline">\(2^{f-q}\)</span> designs, say <span class="math inline">\(d^\star\)</span> and <span class="math inline">\(d^\dagger\)</span>, let <span class="math inline">\(r\)</span> be the smallest integer such that <span class="math inline">\(w_r(d^\star) \ne w_r(d^\dagger)\)</span>. Then design <span class="math inline">\(d^\star\)</span> is said to have less <strong>aberration</strong> than design <span class="math inline">\(d^\dagger\)</span> if</p>
<p><span class="math display">\[
w_r(d^\star) &lt; w_r(d^\dagger)\,.
\]</span></p>
<p>If no design has less aberration than <span class="math inline">\(d^\star\)</span>, then <span class="math inline">\(d^\star\)</span> has <strong>minimum aberration</strong>.</p>
</div>
<p>Consider again designs <span class="math inline">\(d_1\)</span> and <span class="math inline">\(d_2\)</span> from above (<span class="math inline">\(2^{7-2}\)</span> fractions). Here,</p>
<p><span class="math display">\[
\begin{array}{ccccccc}
w_3(d_1) &amp; = &amp; 0 &amp; = &amp; w_3(d_2) &amp; = &amp; 0 \\
w_4(d_1) &amp; = &amp; 2 &amp; &gt; &amp; w_3(d_1) &amp; = &amp; 1 \,, \\
\end{array}
\]</span>
and hence <span class="math inline">\(d_2\)</span> has less aberration than <span class="math inline">\(d_1\)</span>. In fact, <span class="math inline">\(d_2\)</span> has minimum aberration.</p>
<p>We can use <code>FrF2</code> to find designs of a specific resolution using the <code>resolution</code> argument (and leaving <code>nruns</code> and <code>generators</code> unspecified). The resulting design will have the minimum number of runs required to obtain the requested resolution.</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="fractional-factorial.html#cb210-1"></a>ff.<span class="dv">2</span>.<span class="dv">6</span>.<span class="fl">2.</span>r &lt;-<span class="st"> </span>FrF2<span class="op">::</span><span class="kw">FrF2</span>(<span class="dt">nfactors =</span> <span class="dv">6</span>, <span class="dt">resolution =</span> <span class="dv">4</span>, </span>
<span id="cb210-2"><a href="fractional-factorial.html#cb210-2"></a>                         <span class="dt">randomize =</span> F, <span class="dt">alias.info =</span> <span class="dv">3</span>)</span>
<span id="cb210-3"><a href="fractional-factorial.html#cb210-3"></a><span class="kw">design.info</span>(ff.<span class="dv">2</span>.<span class="dv">6</span>.<span class="fl">2.</span>r)<span class="op">$</span>aliased</span></code></pre></div>
<pre><code>## $legend
## [1] &quot;A=A&quot; &quot;B=B&quot; &quot;C=C&quot; &quot;D=D&quot; &quot;E=E&quot; &quot;F=F&quot;
## 
## $main
## [1] &quot;A=BCE=BDF&quot; &quot;B=ACE=ADF&quot; &quot;C=ABE=DEF&quot; &quot;D=ABF=CEF&quot; &quot;E=ABC=CDF&quot; &quot;F=ABD=CDE&quot;
## 
## $fi2
## [1] &quot;AB=CE=DF&quot; &quot;AC=BE&quot;    &quot;AD=BF&quot;    &quot;AE=BC&quot;    &quot;AF=BD&quot;    &quot;CD=EF&quot;    &quot;CF=DE&quot;   
## 
## $fi3
## [1] &quot;ACD=AEF=BCF=BDE&quot; &quot;ACF=ADE=BCD=BEF&quot;</code></pre>
<p>When <code>generators</code> and <code>resolution</code> are not specified, <code>FrF2</code> function selects designs from catalogues of good designs, most of which have minimum aberration.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="fractional-factorial.html#cb212-1"></a>ff.<span class="dv">2</span>.<span class="dv">6</span>.<span class="fl">2.</span>a &lt;-<span class="st"> </span>FrF2<span class="op">::</span><span class="kw">FrF2</span>(<span class="dt">nfactors =</span> <span class="dv">6</span>, <span class="dt">nruns =</span> <span class="dv">16</span>, </span>
<span id="cb212-2"><a href="fractional-factorial.html#cb212-2"></a>                         <span class="dt">randomize =</span> F, <span class="dt">alias.info =</span> <span class="dv">3</span>)</span>
<span id="cb212-3"><a href="fractional-factorial.html#cb212-3"></a><span class="kw">design.info</span>(ff.<span class="dv">2</span>.<span class="dv">6</span>.<span class="fl">2.</span>a)<span class="op">$</span>aliased</span></code></pre></div>
<pre><code>## $legend
## [1] &quot;A=A&quot; &quot;B=B&quot; &quot;C=C&quot; &quot;D=D&quot; &quot;E=E&quot; &quot;F=F&quot;
## 
## $main
## [1] &quot;A=BCE=BDF&quot; &quot;B=ACE=ADF&quot; &quot;C=ABE=DEF&quot; &quot;D=ABF=CEF&quot; &quot;E=ABC=CDF&quot; &quot;F=ABD=CDE&quot;
## 
## $fi2
## [1] &quot;AB=CE=DF&quot; &quot;AC=BE&quot;    &quot;AD=BF&quot;    &quot;AE=BC&quot;    &quot;AF=BD&quot;    &quot;CD=EF&quot;    &quot;CF=DE&quot;   
## 
## $fi3
## [1] &quot;ACD=AEF=BCF=BDE&quot; &quot;ACF=ADE=BCD=BEF&quot;</code></pre>
</div>
<div id="frac-anal" class="section level2">
<h2><span class="header-section-number">6.4</span> Analysis of fractional factorial designs</h2>
<p>The analysis can proceed as for full factorial designs (Chapter <a href="factorial.html#factorial">4</a>). Assuming only one factorial effect in each alias string is non-zero, we can estimate <span class="math inline">\(2^{f-q}-1\)</span> factorial effects (one from each string) either by fitting the unit-treatment model or the corresponding regression model.</p>
<p>For Example <a href="fractional-factorial.html#exm:spring-experiment">6.1</a>, we can use the unit-treatment model and contrasts to estimate all main effects and selected two-factor interactions, assuming all other factorial effects are zero.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="fractional-factorial.html#cb214-1"></a>spring<span class="op">$</span>treatment &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">16</span>)</span>
<span id="cb214-2"><a href="fractional-factorial.html#cb214-2"></a>spring.ut &lt;-<span class="st"> </span><span class="kw">lm</span>(height <span class="op">~</span><span class="st"> </span>treatment, <span class="dt">data =</span> spring)</span>
<span id="cb214-3"><a href="fractional-factorial.html#cb214-3"></a>fac.contrasts.emmc &lt;-<span class="st"> </span><span class="cf">function</span>(nlevs) {</span>
<span id="cb214-4"><a href="fractional-factorial.html#cb214-4"></a>  spring.num &lt;-<span class="st"> </span><span class="kw">apply</span>(spring[, <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;E&quot;</span>)], <span class="dv">2</span>, fac_to_numeric)</span>
<span id="cb214-5"><a href="fractional-factorial.html#cb214-5"></a>  <span class="kw">data.frame</span>(<span class="kw">model.matrix</span>(<span class="op">~</span><span class="st"> </span>. <span class="op">+</span><span class="st"> </span>A<span class="op">:</span>B <span class="op">+</span><span class="st"> </span>A<span class="op">:</span>C <span class="op">+</span><span class="st"> </span>A<span class="op">:</span>D <span class="op">+</span><span class="st"> </span>A<span class="op">:</span>E <span class="op">+</span><span class="st"> </span>B<span class="op">:</span>C </span>
<span id="cb214-6"><a href="fractional-factorial.html#cb214-6"></a>                          <span class="op">+</span><span class="st"> </span>B<span class="op">:</span>D <span class="op">+</span><span class="st"> </span>B<span class="op">:</span>E, <span class="kw">data.frame</span>(spring.num))[, <span class="dv">-1</span>] <span class="op">/</span><span class="st"> </span><span class="dv">8</span>)</span>
<span id="cb214-7"><a href="fractional-factorial.html#cb214-7"></a>}</span>
<span id="cb214-8"><a href="fractional-factorial.html#cb214-8"></a>spring.emm &lt;-<span class="st"> </span>emmeans<span class="op">::</span><span class="kw">emmeans</span>(spring.ut, <span class="op">~</span><span class="st"> </span>treatment)</span>
<span id="cb214-9"><a href="fractional-factorial.html#cb214-9"></a>emmeans<span class="op">::</span><span class="kw">contrast</span>(spring.emm, <span class="st">&#39;fac.contrasts&#39;</span>)</span></code></pre></div>
<pre><code>##  contrast estimate  SE df t.ratio p.value
##  A         -0.2612 NaN  0     NaN     NaN
##  B          0.2213 NaN  0     NaN     NaN
##  C          0.1762 NaN  0     NaN     NaN
##  D          0.0288 NaN  0     NaN     NaN
##  E          0.1037 NaN  0     NaN     NaN
##  A.B        0.0838 NaN  0     NaN     NaN
##  A.C       -0.1663 NaN  0     NaN     NaN
##  A.D        0.0563 NaN  0     NaN     NaN
##  A.E        0.0262 NaN  0     NaN     NaN
##  B.C        0.0163 NaN  0     NaN     NaN
##  B.D        0.0187 NaN  0     NaN     NaN
##  B.E       -0.0362 NaN  0     NaN     NaN</code></pre>
<p>When looking at this output, we must remember the aliasing scheme and recognise that we can only estimate these effects if all of their alaises are zero. Otherwise, each of these factorial effects is biased and not estimable (we are actually estimating the linear combination of all the aliased effects).</p>
<p>Alternatively, we can fit the regression model directly in the contrasts; <code>lm</code> automatically recognises which pairs of effects are aliased, and chooses the lexicographically first effect to include in the model.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="fractional-factorial.html#cb216-1"></a>spring.lm &lt;-<span class="st"> </span><span class="kw">lm</span>(height <span class="op">~</span><span class="st"> </span>(A <span class="op">+</span><span class="st"> </span>B <span class="op">+</span><span class="st"> </span>C <span class="op">+</span><span class="st"> </span>D <span class="op">+</span><span class="st"> </span>E) <span class="op">^</span><span class="st"> </span><span class="dv">5</span>, <span class="dt">data =</span> spring)</span>
<span id="cb216-2"><a href="fractional-factorial.html#cb216-2"></a><span class="kw">c</span>(<span class="kw">na.omit</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">coef</span>(spring.lm)[<span class="op">-</span><span class="dv">1</span>]))</span></code></pre></div>
<pre><code>##       A1       B1       C1       D1       E1    A1:B1    A1:C1    A1:D1 
## -0.26125  0.22125  0.17625  0.02875  0.10375  0.08375 -0.16625  0.05625 
##    A1:E1    B1:C1    B1:D1    B1:E1 A1:B1:C1 A1:B1:D1 A1:B1:E1 
##  0.02625  0.01625  0.01875 -0.03625  0.00875 -0.03875 -0.04875</code></pre>
<p>In this experiment, there are three alias string that only include three-factor interactions. We may wish to use these three degrees of freedom to estimate <span class="math inline">\(\sigma^2\)</span>, under the assumption that all six interactions involved in these three strings are zero.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="fractional-factorial.html#cb218-1"></a>spring.lm &lt;-<span class="st"> </span><span class="kw">lm</span>(height <span class="op">~</span><span class="st"> </span>(A <span class="op">+</span><span class="st"> </span>B <span class="op">+</span><span class="st"> </span>C <span class="op">+</span><span class="st"> </span>D <span class="op">+</span><span class="st"> </span>E) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">data =</span> spring)</span>
<span id="cb218-2"><a href="fractional-factorial.html#cb218-2"></a><span class="kw">anova</span>(spring.lm)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: height
##           Df Sum Sq Mean Sq F value Pr(&gt;F)   
## A          1 0.2730  0.2730   51.78 0.0055 **
## B          1 0.1958  0.1958   37.13 0.0089 **
## C          1 0.1243  0.1243   23.56 0.0167 * 
## D          1 0.0033  0.0033    0.63 0.4863   
## E          1 0.0431  0.0431    8.17 0.0647 . 
## A:B        1 0.0281  0.0281    5.32 0.1043   
## A:C        1 0.1106  0.1106   20.97 0.0196 * 
## A:D        1 0.0127  0.0127    2.40 0.2191   
## A:E        1 0.0028  0.0028    0.52 0.5220   
## B:C        1 0.0011  0.0011    0.20 0.6848   
## B:D        1 0.0014  0.0014    0.27 0.6412   
## B:E        1 0.0053  0.0053    1.00 0.3917   
## Residuals  3 0.0158  0.0053                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="blocking-fractional-fractorial-designs" class="section level2">
<h2><span class="header-section-number">6.5</span> Blocking fractional fractorial designs</h2>
<p>We block fractional factorial designs using the same approach as Chapter <a href="block-factorial.html#block-factorial">5</a>. To block a <span class="math inline">\(2^{f-q}\)</span> design into <span class="math inline">\(b = 2^m\)</span> blocks, we choose <span class="math inline">\(m\)</span> factorial effects to confound with blocks, also confounding all products of these <span class="math inline">\(m\)</span> effects. However, we of course also confound the <span class="math inline">\(2^q-1\)</span> aliases of each of these <span class="math inline">\(2^m-1\)</span> effects. Hence, we actually choose to confound <span class="math inline">\(2^m-1\)</span> <em>strings of factorial effects</em> with blocks.</p>
<p>We must pay particular attention to make sure we do not accidentically confound a lower-order effect through the aliasing scheme. We can also use <code>FrF2</code> to find blocked factorial designs.</p>
<div class="example">
<p><span id="exm:block-fractional" class="example"><strong>Example 6.3  </strong></span>Consider a <span class="math inline">\(2^{6-2}\)</span> design with defining relation</p>
<p><span class="math display">\[
I = ABCE = ABDF = CDEF\,.
\]</span>
To split this design into <span class="math inline">\(b=2^2 = 4\)</span> blocks of size <span class="math inline">\(k=4\)</span>, we choose <span class="math inline">\(m=2\)</span> defining blocks, and also confound their product.</p>
<p><span class="math display">\[
\begin{array}{ccc}
\mathrm{Block}_1 &amp; = &amp; ACD \\
\mathrm{Block}_2 &amp; = &amp; BCD \\
\mathrm{Block}_1\mathrm{Block}_2 &amp; = &amp; AB\,.
\end{array}
\]</span>
We also confound all aliases of these effects:</p>
<p><span class="math display">\[
\begin{array}{ccccccccc}
\mathrm{Block}_1 &amp; = &amp; ACD &amp; = &amp; BDE &amp; = &amp; BCF &amp; = &amp; ADEF \\
\mathrm{Block}_2 &amp; = &amp; BCD &amp; = &amp; ADE &amp; = &amp; ACF &amp; = &amp; BEF \\
\mathrm{Block}_1\mathrm{Block}_2 &amp; = &amp; AB &amp; = &amp; CE &amp; = &amp; DF &amp; = &amp; ABCDEF \,.
\end{array}
\]</span>
We can also find this design using <code>FrF2</code>, combining the arguments <code>generators</code> and <code>blocks</code>.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="fractional-factorial.html#cb220-1"></a>ff.<span class="dv">2</span>.<span class="dv">6</span>.<span class="fl">2.</span>b<span class="fl">.4</span> &lt;-<span class="st"> </span>FrF2<span class="op">::</span><span class="kw">FrF2</span>(<span class="dt">nruns =</span> <span class="dv">16</span>, <span class="dt">nfactors =</span> <span class="dv">6</span>, <span class="dt">generators =</span> <span class="kw">c</span>(<span class="st">&quot;ABC&quot;</span>, <span class="st">&quot;ABD&quot;</span>), <span class="dt">blocks =</span> <span class="kw">c</span>(<span class="st">&quot;ACD&quot;</span>, <span class="st">&quot;BCD&quot;</span>),</span>
<span id="cb220-2"><a href="fractional-factorial.html#cb220-2"></a>                           <span class="dt">randomize =</span> F, <span class="dt">alias.block.2fis =</span> T, <span class="dt">alias.info =</span> <span class="dv">3</span>)</span>
<span id="cb220-3"><a href="fractional-factorial.html#cb220-3"></a><span class="kw">design.info</span>(ff.<span class="dv">2</span>.<span class="dv">6</span>.<span class="fl">2.</span>b<span class="fl">.4</span>)<span class="op">$</span>aliased</span></code></pre></div>
<pre><code>## $legend
## [1] &quot;A=A&quot; &quot;B=B&quot; &quot;C=C&quot; &quot;D=D&quot; &quot;E=E&quot; &quot;F=F&quot;
## 
## $main
## [1] &quot;A=BCE=BDF&quot; &quot;B=ACE=ADF&quot; &quot;C=ABE=DEF&quot; &quot;D=ABF=CEF&quot; &quot;E=ABC=CDF&quot; &quot;F=ABD=CDE&quot;
## 
## $fi2
## [1] &quot;AC=BE&quot; &quot;AD=BF&quot; &quot;AE=BC&quot; &quot;AF=BD&quot; &quot;CD=EF&quot; &quot;CF=DE&quot;
## 
## $fi3
## character(0)</code></pre>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="fractional-factorial.html#cb222-1"></a><span class="kw">design.info</span>(ff.<span class="dv">2</span>.<span class="dv">6</span>.<span class="fl">2.</span>b<span class="fl">.4</span>)<span class="op">$</span>aliased.with.blocks</span></code></pre></div>
<pre><code>##  [1] &quot;AB&quot;  &quot;CE&quot;  &quot;DF&quot;  &quot;ACD&quot; &quot;ACF&quot; &quot;ADE&quot; &quot;AEF&quot; &quot;BCD&quot; &quot;BCF&quot; &quot;BDE&quot; &quot;BEF&quot;</code></pre>
<p>One block of this design can be found by finding all the treatment combinations that satisfy, for example,</p>
<p><span class="math display">\[
ABCE = +1, ABDF = +1, ACD = -1, BCD = -1\,.
\]</span>
Fixing values for <span class="math inline">\(ABCE\)</span> and <span class="math inline">\(ABDF\)</span>, the other blocks are formed from the other 3 combinations of each of <span class="math inline">\(ACD\)</span> and <span class="math inline">\(BCD\)</span> being equal to <span class="math inline">\(\pm 1\)</span>. We can also use <code>FrF2</code>.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="fractional-factorial.html#cb224-1"></a>block12 &lt;-<span class="st"> </span>ff.<span class="dv">2</span>.<span class="dv">6</span>.<span class="fl">2.</span>b<span class="fl">.4</span>[<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>, ]</span>
<span id="cb224-2"><a href="fractional-factorial.html#cb224-2"></a>block34 &lt;-<span class="st"> </span>ff.<span class="dv">2</span>.<span class="dv">6</span>.<span class="fl">2.</span>b<span class="fl">.4</span>[<span class="dv">9</span><span class="op">:</span><span class="dv">16</span>, ]</span>
<span id="cb224-3"><a href="fractional-factorial.html#cb224-3"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">cbind</span>(block12, block34), </span>
<span id="cb224-4"><a href="fractional-factorial.html#cb224-4"></a>      <span class="dt">caption =</span> <span class="st">&quot;Fractional factorial </span></span>
<span id="cb224-5"><a href="fractional-factorial.html#cb224-5"></a><span class="st">      $2^{6-2}$ design in $b=4$ blocks of size $k=4$.&quot;</span>,</span>
<span id="cb224-6"><a href="fractional-factorial.html#cb224-6"></a>      <span class="dt">align =</span> <span class="st">&quot;r&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:frac-block-design">Table 6.5: </span>Fractional factorial
<span class="math inline">\(2^{6-2}\)</span> design in <span class="math inline">\(b=4\)</span> blocks of size <span class="math inline">\(k=4\)</span>.</caption>
<thead>
<tr class="header">
<th align="right">Blocks</th>
<th align="right">A</th>
<th align="right">B</th>
<th align="right">C</th>
<th align="right">D</th>
<th align="right">E</th>
<th align="right">F</th>
<th align="right">Blocks</th>
<th align="right">A</th>
<th align="right">B</th>
<th align="right">C</th>
<th align="right">D</th>
<th align="right">E</th>
<th align="right">F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">3</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">4</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">-1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">-1</td>
<td align="right">-1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
<p>Analysis proceeds as before, except no factorial effect can be estimated that is within an alias string that is confounded with blocks. For Example, split the spring experiment from Exa,ple <a href="fractional-factorial.html#exm:spring-experiment">6.1</a> into <span class="math inline">\(b=2\)</span> blocks of size <span class="math inline">\(k=8\)</span> using confounding the alias string <span class="math inline">\(ABE = ACD\)</span> with blocks.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="fractional-factorial.html#cb225-1"></a>spring.blocks &lt;-<span class="st"> </span>spring</span>
<span id="cb225-2"><a href="fractional-factorial.html#cb225-2"></a>spring.blocks<span class="op">$</span>blocks &lt;-<span class="st"> </span><span class="kw">with</span>(<span class="kw">data.frame</span>(spring), <span class="kw">fac_to_numeric</span>(A) <span class="op">*</span><span class="st"> </span><span class="kw">fac_to_numeric</span>(B) <span class="op">*</span><span class="st"> </span><span class="kw">fac_to_numeric</span>(C))</span>
<span id="cb225-3"><a href="fractional-factorial.html#cb225-3"></a>springb.lm &lt;-<span class="st"> </span><span class="kw">lm</span>(height <span class="op">~</span><span class="st"> </span>blocks <span class="op">+</span><span class="st"> </span>(A <span class="op">+</span><span class="st"> </span>B <span class="op">+</span><span class="st"> </span>C <span class="op">+</span><span class="st"> </span>D <span class="op">+</span><span class="st"> </span>E) <span class="op">^</span><span class="st"> </span><span class="dv">3</span>, <span class="dt">data =</span> spring.blocks)</span>
<span id="cb225-4"><a href="fractional-factorial.html#cb225-4"></a><span class="kw">anova</span>(springb.lm)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: height
##           Df Sum Sq Mean Sq F value Pr(&gt;F)
## blocks     1 0.0003  0.0003     NaN    NaN
## A          1 0.2730  0.2730     NaN    NaN
## B          1 0.1958  0.1958     NaN    NaN
## C          1 0.1243  0.1243     NaN    NaN
## D          1 0.0033  0.0033     NaN    NaN
## E          1 0.0431  0.0431     NaN    NaN
## A:B        1 0.0281  0.0281     NaN    NaN
## A:C        1 0.1106  0.1106     NaN    NaN
## A:D        1 0.0127  0.0127     NaN    NaN
## A:E        1 0.0028  0.0028     NaN    NaN
## B:C        1 0.0011  0.0011     NaN    NaN
## B:D        1 0.0014  0.0014     NaN    NaN
## B:E        1 0.0053  0.0053     NaN    NaN
## A:B:D      1 0.0060  0.0060     NaN    NaN
## A:B:E      1 0.0095  0.0095     NaN    NaN
## Residuals  0 0.0000     NaN</code></pre>
</div>
<div id="exercises-5" class="section level2">
<h2><span class="header-section-number">6.6</span> Exercises</h2>
<ol style="list-style-type: decimal">
<li><p>A <span class="math inline">\(2^{5-2}\)</span> design has generators <span class="math inline">\(ACD\)</span> and <span class="math inline">\(BCE\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Write down the full defining relation. What resolution is this design?</p></li>
<li><p>After analysis, factor <span class="math inline">\(E\)</span> turns out to be unimportant. By assuming that all effects involving factor <span class="math inline">\(E\)</span> and all three-factor and higher-order interactions are negligible, determine which two-factor interactions can be estimated together with the four main effects of factors <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(C\)</span> and <span class="math inline">\(D\)</span>.</p></li>
</ol></li>
<li><p>Consider the following two fractional factorial designs.</p>
<ol style="list-style-type: lower-roman">
<li>A <span class="math inline">\(2^{6-2}\)</span> design with generators <span class="math inline">\(ABCDE\)</span> and <span class="math inline">\(ABDF\)</span>.</li>
<li>A <span class="math inline">\(2^{6-2}\)</span> design with generators <span class="math inline">\(ABCE\)</span> and <span class="math inline">\(ABDF\)</span>.</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li><p>What is the resolution of each design?</p></li>
<li><p>Which design would be preferred under the criterion of minimum aberration?</p></li>
<li><p>For design (ii), if we know that any two-factor interaction involving factor <span class="math inline">\(F\)</span> is negligible, which other two-factor interactions can be estimated under the assumption that three-factor and higher-order interactions are also negligible?</p></li>
</ol></li>
</ol>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-WH2009">
<p>Wu, C. F. J. and Hamada, M. (2009) <em>Experiments: Planning, Analysis, and Parameter Design Optimization</em>. 2nd ed. New York: Wiley.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="37">
<li id="fn37"><p>If we only run one-half of the treatments from a <span class="math inline">\(2^5\)</span> design, the design contains <span class="math inline">\(\frac{2^5}{2} = 2^{5-1}\)</span> treatments<a href="fractional-factorial.html#fnref37" class="footnote-back">↩︎</a></p></li>
<li id="fn38"><p>Except for the defining relation, where no effects are estimable<a href="fractional-factorial.html#fnref38" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="block-factorial.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown_math3014-6027.pdf", "bookdown_math3014-6027.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
