[["fractional-factorial.html", "Chapter 6 Fractional factorial designs 6.1 Estimability and aliasing 6.2 General method for choosing a fractional factorial design 6.3 Resolution and aberration 6.4 Analysis of fractional factorial designs 6.5 Blocking fractional fractorial designs 6.6 Exercises", " Chapter 6 Fractional factorial designs The factorial designs we studied in Chapters 4 and 4 can involve a large number of treatments, for even a moderate number of factors (Table 6.1). size &lt;- data.frame(1:15, 2^(1:15)) knitr::kable(size, col.names = c(&quot;No. factors&quot;, &quot;No. of trts&quot;), caption = &quot;Number of treatments in a $2^f$ factorial designs for different numbers, $f$, of factors.&quot;) Table 6.1: Number of treatments in a \\(2^f\\) factorial designs for different numbers, \\(f\\), of factors. No. factors No. of trts 1 2 2 4 3 8 4 16 5 32 6 64 7 128 8 256 9 512 10 1024 11 2048 12 4096 13 8192 14 16384 15 32768 For larger numbers of factors, resource constraints may mean it is not possible to run an experiment using all \\(2^f\\) treatments. Also, many degrees of freedom in these experiments are used to estimate high-order interactions. For example, in a \\(2^5\\) experiment, 16 degrees of freedom are used to estimate three-factor and higher interactions, half the size of the experiment. The principles of effect hierarchy and sparsity (Section 4.2) suggest this is probably wasteful. We can select smaller experiments by using a subset, or fraction of the treatments of size \\(2^{f-q}\\): divide the treatments in subsets by confounding \\(q\\) factorial effects (and their products), as in blocking; only use one of the subsets in the experiment. Example 6.1 Spring experiment (Wu and Hamada, 2009, ch. 5) Consider an industrial experiment to investigate the effect of \\(f=5\\) factors on the unloaded height of a spring produced using a heat treatment. The five factors are described in Table 6.2. factor.name &lt;- c(&quot;Quench temperature (F)&quot;, &quot;Heat temperature (F)&quot;, &quot;Heating time (s)&quot;, &quot;Transfer time (s)&quot;, &quot;Hold-down time (s)&quot;) low.level &lt;- c(&quot;130-150&quot;, 1840, 23, 10, 2) high.level &lt;- c(&quot;150-170&quot;, 1880, 25, 12, 3) spring.factors &lt;- data.frame(factor = factor.name, low = low.level, high = high.level) row.names(spring.factors) &lt;- LETTERS[1:5] knitr::kable(spring.factors, col.names = c(&quot;Factor&quot;, &quot;Low level&quot;, &quot;High level&quot;), align = c(&quot;l&quot;, &quot;r&quot;, &quot;r&quot;), caption = &quot;Spring experiment: factors and levels&quot;) Table 6.2: Spring experiment: factors and levels Factor Low level High level A Quench temperature (F) 130-150 150-170 B Heat temperature (F) 1840 1880 C Heating time (s) 23 25 D Transfer time (s) 10 12 E Hold-down time (s) 2 3 Enough experimental units were available to perform \\(n=16\\) runs, which is one-half of the total number of treatments. We refer to this type of design as a one-half fractional replicate of the full factorial design, or a \\(2^{5-1}\\) fractional factorial design1. The design was constructed by confounding \\(q=1\\) factorial effects with blocks, the interaction \\(BCDE\\) was chosen, and running just one of the two resulting subsets, see Table 6.3 where FrF2 is used to generate the design. spring &lt;- FrF2::FrF2(nruns = 16, nfactors = 5, generators = &quot;BCD&quot;, randomize = F) spring$height &lt;- c(7.54, 7.20, 7.69, 7.63, 7.94, 7.40, 7.95, 7.62, 7.52, 7.52, 7.63, 7.65, 7.79, 7.29, 8.07, 7.73) knitr::kable(spring, caption = &quot;Spring experiment: 16 run design.&quot;, align = rep(&quot;r&quot;, 6)) Table 6.3: Spring experiment: 16 run design. A B C D E height -1 -1 -1 -1 -1 7.54 1 -1 -1 -1 -1 7.20 -1 1 -1 -1 1 7.69 1 1 -1 -1 1 7.63 -1 -1 1 -1 1 7.94 1 -1 1 -1 1 7.40 -1 1 1 -1 -1 7.95 1 1 1 -1 -1 7.62 -1 -1 -1 1 1 7.52 1 -1 -1 1 1 7.52 -1 1 -1 1 -1 7.63 1 1 -1 1 -1 7.65 -1 -1 1 1 -1 7.79 1 -1 1 1 -1 7.29 -1 1 1 1 1 8.07 1 1 1 1 1 7.73 Clearly, using a subset of the treatments, we will no longer be able to estimate all the factorial effects (we have insufficient degrees of freedom). We have confounded the interaction \\(BCDE\\), and hence clearly the contrast coefficients for this effect will be constant in our design. We say the interaction \\(BCDE\\) is aliased with the mean, and we write this as \\(I = BCDE\\). This expression is called the defining relation, as knowledge of which factorial effects are aliased with the mean completely define the fractional factorial. fac_to_numeric &lt;- function(x) as.numeric(as.character(x)) BCDE &lt;- fac_to_numeric(spring$B) * fac_to_numeric(spring$C) * fac_to_numeric(spring$D) * fac_to_numeric(spring$E) BCDE ## [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 This removes one factorial effect from consideration, but we are still short on degrees of freedom. What are the other consequences of using a fractional factorial design? As the contrast coefficients for the interaction \\(BCDE\\) are constant, the contrast coefficients for any pairs of factorial effects whose (hadamard) product form \\(BCDE\\) will be equal. For example, the contrast coefficient vectors for interactions \\(BC\\) and \\(DE\\) will be equal, as will the vectors for the main effect \\(B\\) and the interaction \\(CDE\\), and so on. BC &lt;- fac_to_numeric(spring$B) * fac_to_numeric(spring$C) DE &lt;- fac_to_numeric(spring$D) * fac_to_numeric(spring$E) BC DE all.equal(BC, DE) ## [1] 1 1 -1 -1 -1 -1 1 1 1 1 -1 -1 -1 -1 1 1 ## [1] 1 1 -1 -1 -1 -1 1 1 1 1 -1 -1 -1 -1 1 1 ## [1] TRUE B &lt;- fac_to_numeric(spring$B) CDE &lt;- fac_to_numeric(spring$C) * fac_to_numeric(spring$D) * fac_to_numeric(spring$E) B CDE all.equal(B, CDE) ## [1] -1 -1 1 1 -1 -1 1 1 -1 -1 1 1 -1 -1 1 1 ## [1] -1 -1 1 1 -1 -1 1 1 -1 -1 1 1 -1 -1 1 1 ## [1] TRUE We say these factorial effects are aliased. From the defining relation, we can derive the complete aliasing scheme for a fractional factorial design. For the example, \\[\\begin{align} I &amp; = BCDE \\\\ A &amp; = ABCDE \\\\ B &amp; = CDE \\\\ C &amp; = BDE \\\\ D &amp; = BCE \\\\ E &amp; = BCD \\\\ AB &amp; = ACDE \\\\ AC &amp; = ABDE \\\\ AD &amp; = ABCE \\\\ AE &amp; = ABCD \\\\ BC &amp; = DE \\\\ BD &amp; = CE \\\\ BE &amp; = CD \\\\ ABC &amp; = ADE \\\\ ABD &amp; = ACE \\\\ ABE &amp; = ACD \\\\ \\end{align}\\] The aliasing scheme contains \\(2^{f-q} = 2^{5-1} = 16\\) “strings”, each one containing \\(2^q = 2^1 = 2\\) “words”. The design is not capable to distinguishing between factorial effects in the same alias string. We can also generate this information using the aliases function from FrF2. spring.lm &lt;- lm(height ~ (.)^5, data = spring) FrF2::aliases(spring.lm) ## ## A = A:B:C:D:E ## B = C:D:E ## C = B:D:E ## D = B:C:E ## E = B:C:D ## A:B = A:C:D:E ## A:C = A:B:D:E ## A:D = A:B:C:E ## A:E = A:B:C:D ## B:C = D:E ## B:D = C:E ## B:E = C:D ## A:B:C = A:D:E ## A:B:D = A:C:E ## A:B:E = A:C:D Definition 6.1 A regular \\(2^{f-q}\\)fractional factorial design is constructed by aliasing \\(2^q-1\\) factorial effects with the mean; \\(q\\) of these effects can be chosen independently, the others are formed via the hadamard product of the contrast coefficients for the \\(q\\) effects, How do we chose the factorial effects to alias with the mean? As with blocking, we tend to choose higher-order effects, taking care when \\(q&gt;1\\) not to inadvertently alias together lower-order effects (see later examples). For Example 6.1, a slightly unusual defining relation was chosen. It would be more common to use \\(I = ABCDE\\), leading to the aliasing scheme: \\[\\begin{align} I &amp; = ABCDE \\\\ A &amp; = BCDE \\\\ B &amp; = ACDE \\\\ C &amp; = ABDE \\\\ D &amp; = ABCE \\\\ E &amp; = ABCD \\\\ AB &amp; = CDE \\\\ AC &amp; = BDE \\\\ AD &amp; = BCE \\\\ AE &amp; = BCD \\\\ BC &amp; = ADE \\\\ BD &amp; = ACE \\\\ BE &amp; = ACD \\\\ CD &amp; = ABE \\\\ CE &amp; = ABD \\\\ DE &amp; = ABC \\\\ \\end{align}\\] This defining relation results in main effects being aliased with four-factor interactions and, perhaps more importantly, no pairs of two-factor interactions aliased together. The original design from Example ?? might be used if factor \\(A\\) and its interactions were a priori thought likely to be important (two-factor interactions involving factor \\(A\\) are aliased with four-factor interactions). 6.1 Estimability and aliasing Any factorial effect in an alias string is only estimable if all other effects in that string are assumed zero2. Wd can study this further by introducing the alias matrix. Definition 6.2 Assume a linear data generating model \\[ \\bY = X_1\\boldsymbol{\\beta}_1 + X_2\\boldsymbol{\\beta}_2 + \\boldsymbol{\\varepsilon}\\,, \\] where \\(\\bY\\) is an \\(n\\)-vector of responses, \\(X_1\\) and \\(X_2\\) are \\(n\\times p_1\\) and \\(n\\times p_2\\) model matrices, respectively, with \\(\\boldsymbol{\\beta}_1\\) and \\(\\boldsymbol{\\beta}_2\\) corresponding \\(p_1\\)- and \\(p_2\\)-vectors of parameters and random errors \\(\\varepsilon ~ N(\\boldsymbol{0}, I_n\\sigma^2)\\). If the submodel \\[ \\bY = X_1\\boldsymbol{\\beta}_1 + \\boldsymbol{\\varepsilon}\\,, \\] is fitted to the response data, then \\(\\hat{\\boldsymbol{\\beta}}_1 = (X_1^{\\mathrm{T}}X_1)^{-1}X_1^{\\mathrm{T}}\\bY\\), and \\[\\begin{align*} E(\\hat{\\boldsymbol{\\beta}}_1) &amp; = \\boldsymbol{\\beta}_1 + (X_1^{\\mathrm{T}}X_1)^{-1}X_1^{\\mathrm{T}}X_2\\boldsymbol{\\beta}_2 \\\\ &amp; = \\boldsymbol{\\beta}_1 + A\\boldsymbol{\\beta}_2\\,, \\end{align*}\\] where \\(A = (X_1^{\\mathrm{T}}X_1)^{-1}X_1^{\\mathrm{T}}X_2\\) is the alias matrix. We also introduce an alternative definition of estimability. Definition 6.3 A linear combination of parameters \\(\\boldsymbol{c}^{\\mathrm{T}}\\boldsymbol{\\theta}\\) is estimable if and only if there exists a linear combination of the responses \\(\\boldsymbol{a}^{\\mathrm{T}}\\bY\\) such that \\[ E(\\boldsymbol{a}^{\\mathrm{T}}\\bY) = c^{\\mathrm{T}}\\boldsymbol{\\theta}\\,. \\] Now assume that using a two-level fractional factorial design, we will estimate one factorial effect (equivalently, the corresponding regression coefficient) from each alias string. Then the \\(A\\) matrix will have entries 0, -1 or +1, depending on the defining relation of the fraction. Each regression parameter will be biased by the parameters corresponding to other factorial effects in the alias string. Hence, by Definition @ref{def:alt-estimability}, each factorial effect is only estimable under the assumption that all other factorial effects in the alias string are zero. For Example 6.1 we can generate the alias matrix using the alias function. t(alias(spring.lm)$Complete) ## A1:C1:D1 A1:C1:E1 A1:D1:E1 B1:C1:D1 B1:C1:E1 B1:D1:E1 C1:D1:E1 ## (Intercept) 0 0 0 0 0 0 0 ## A1 0 0 0 0 0 0 0 ## B1 0 0 0 0 0 0 1 ## C1 0 0 0 0 0 1 0 ## D1 0 0 0 0 1 0 0 ## E1 0 0 0 1 0 0 0 ## A1:B1 0 0 0 0 0 0 0 ## A1:C1 0 0 0 0 0 0 0 ## A1:D1 0 0 0 0 0 0 0 ## A1:E1 0 0 0 0 0 0 0 ## B1:C1 0 0 0 0 0 0 0 ## B1:D1 0 0 0 0 0 0 0 ## B1:E1 0 0 0 0 0 0 0 ## A1:B1:C1 0 0 1 0 0 0 0 ## A1:B1:D1 0 1 0 0 0 0 0 ## A1:B1:E1 1 0 0 0 0 0 0 ## A1:B1:C1:D1 A1:B1:C1:E1 A1:B1:D1:E1 A1:C1:D1:E1 B1:C1:D1:E1 ## (Intercept) 0 0 0 0 1 ## A1 0 0 0 0 0 ## B1 0 0 0 0 0 ## C1 0 0 0 0 0 ## D1 0 0 0 0 0 ## E1 0 0 0 0 0 ## A1:B1 0 0 0 1 0 ## A1:C1 0 0 1 0 0 ## A1:D1 0 1 0 0 0 ## A1:E1 1 0 0 0 0 ## B1:C1 0 0 0 0 0 ## B1:D1 0 0 0 0 0 ## B1:E1 0 0 0 0 0 ## A1:B1:C1 0 0 0 0 0 ## A1:B1:D1 0 0 0 0 0 ## A1:B1:E1 0 0 0 0 0 ## A1:B1:C1:D1:E1 C1:D1 C1:E1 D1:E1 ## (Intercept) 0 0 0 0 ## A1 1 0 0 0 ## B1 0 0 0 0 ## C1 0 0 0 0 ## D1 0 0 0 0 ## E1 0 0 0 0 ## A1:B1 0 0 0 0 ## A1:C1 0 0 0 0 ## A1:D1 0 0 0 0 ## A1:E1 0 0 0 0 ## B1:C1 0 0 0 1 ## B1:D1 0 0 1 0 ## B1:E1 0 1 0 0 ## A1:B1:C1 0 0 0 0 ## A1:B1:D1 0 0 0 0 ## A1:B1:E1 0 0 0 0 6.2 General method for choosing a fractional factorial design To select a \\(2^{f-q}\\) fractional factorial design: choose \\(q\\) independent factorial contrasts for the generators, or defining words, \\(\\nu_1,\\ldots,n_q\\). Typically, we choose higher-order interactions (due to effect hierarchy): \\[ \\nu_{1}=\\boldsymbol{c}_{1},\\ldots,\\nu_{q} = \\boldsymbol{c}_{q}\\,. \\] all the hadamard products of \\(\\boldsymbol{c}_{1},\\dots,\\boldsymbol{c}_{q}\\) are also aliased with the mean, and together give the defining relation: \\[ I = \\nu_1 = \\ldots = \\nu_q = \\nu_1\\nu_q = \\ldots = \\nu_1\\cdots\\nu_q\\,. \\] the aliasing scheme is a list of the \\(2^{f-q}\\) alias strings. Every effect in one string is estimated by the same contrast in the observations: \\[ \\begin{array}{ccccccccccccc} I &amp; = &amp; \\nu_1 &amp; = &amp; \\ldots &amp; = &amp; \\nu_q &amp; = &amp; \\nu_1\\nu_q &amp; = &amp; \\ldots &amp; = &amp; \\nu_1\\cdots\\nu_q \\\\ A &amp; = &amp; A\\nu_1 &amp; = &amp; \\ldots &amp; = &amp; A\\nu_q &amp; = &amp; A\\nu_1\\nu_q &amp; = &amp; \\ldots &amp; = &amp; A\\nu_1\\cdots\\nu_q \\\\ B &amp; = &amp; B\\nu_1 &amp; = &amp; B\\ldots &amp; = &amp; B\\nu_q &amp; = &amp; B\\nu_1\\nu_q &amp; = &amp; \\ldots &amp; = &amp; B\\nu_1\\cdots\\nu_q \\\\ \\vdots \\\\ CD &amp; = &amp; CD\\nu_1 &amp; = &amp; CD\\ldots &amp; = &amp; CD\\nu_q &amp; = &amp; CD\\nu_1\\nu_q &amp; = &amp; CD\\ldots &amp; = &amp; CD\\nu_1\\cdots\\nu_q \\\\ \\vdots \\end{array} \\] All the effects within a single alias string are aliased, and cannot be simultaneously aliased. In fact, the estimation of any effect within an alias string can only proceed if all other effects in the string are assumed zero; otherwise, we can estimate the sum of the effects (see Section 6.1). To find the treatments in a particular fraction, we simply need to solve a set of equations of the form \\[ \\nu_1 = \\pm 1, \\quad \\nu_2 + \\pm 1, \\quad \\ldots \\quad \\nu_q = \\pm 1\\,, \\] with \\(2^{f-q}\\) treatments satisfying the \\(2^q\\) equations corresponding to each choice of \\(\\pm 1\\) for each generator. Example 6.2 Consider a \\(2^{6-2}\\) design, with \\(q=2\\) generators \\(ABCE\\) and \\(BCDF\\). The defining relation is given by \\[ I = ABCE = BCDF = ADEF\\,. \\] The aliasing scheme has \\(2^{6-2} = 16\\) strings, each of which contains \\(2^2 = 4\\) effects or words. \\[ \\begin{array}{ccccccc} I &amp; = &amp; ABCE &amp; = &amp; BCDF &amp; = &amp; ADEF \\\\ A &amp; = &amp; BCE &amp; = &amp; ABCDF &amp; = &amp; DEF \\\\ B &amp; = &amp; ACE &amp; = &amp; CDF &amp; = &amp; ABDEF \\\\ C &amp; = &amp; ABE &amp; = &amp; BDF &amp; = &amp; ACDEF \\\\ D &amp; = &amp; ABCDE &amp; = &amp; BCF &amp; = &amp; AEF \\\\ E &amp; = &amp; ABC &amp; = &amp; BCDEF &amp; = &amp; ADF \\\\ F &amp; = &amp; ABCEF &amp; = &amp; BCD &amp; = &amp; ADE \\\\ AB &amp; = &amp; CE &amp; = &amp; ACDF &amp; = &amp; BDEF \\\\ AC &amp; = &amp; BE &amp; = &amp; ABDF &amp; = &amp; CDEF \\\\ AD &amp; = &amp; BCDE &amp; = &amp; ABCF &amp; = &amp; EF \\\\ AE &amp; = &amp; BC &amp; = &amp; ABCDEF &amp; = &amp; DF \\\\ AF &amp; = &amp; BCEF &amp; = &amp; ABCD &amp; = &amp; DE \\\\ BD &amp; = &amp; ACDE &amp; = &amp; CF &amp; = &amp; ABEF \\\\ BF &amp; = &amp; ACEF &amp; = &amp; CD &amp; = &amp; ABDE \\\\ ABD &amp; = &amp; CDE &amp; = &amp; ACF &amp; = &amp; BEF \\\\ ABF &amp; = &amp; CEF &amp; = &amp; ACD &amp; = &amp; BDE \\\\ \\end{array} \\] This aliasing scheme can result from any one of the four possible fractions defined by \\[ ABCE = \\pm 1\\,,\\quad BCDF = \\pm 1\\,. \\] Each fraction has (essentially) the same statistical properties, except the sign of the biasing coefficients from the alias matrix may be reversed (-1, rather than +1). For example, the treatments in the fraction may be those \\(2^{f-q} = 2^{6-2} = 16\\) treatments that all have \\(ABCE = +1\\) and \\(BCDF = +1\\). We can also use FrF2 to find two-level fractional factorial designs, as we already saw in Example 6.1. The generators argument can be used to specify which factorial effects to use as generators. These are specified using what FrF2 refers to as the \\(f-q\\) base factors. The \\(q\\) generators must specify with which factorial effects in the base factors the \\(q\\) additional factors are aliased. For Example 6.2, a \\(2^{6-2}\\) design, the base factors are \\(A, B, C, D\\) and from our defining relation we have \\(E = ABC\\) and \\(F = BCD\\). ff.2.6.2 &lt;- FrF2::FrF2(nruns = 16, nfactors = 6, generators = c(&quot;ABC&quot;, &quot;BCD&quot;), randomize = F, alias.info = 3) Once FrF2 has generated the design, we can interrogate the aliasing (up to three-factor interactions) using design.info (and using the aliases function, see Example 6.1). library(FrF2) design.info(ff.2.6.2)$aliased ## $legend ## [1] &quot;A=A&quot; &quot;B=B&quot; &quot;C=C&quot; &quot;D=D&quot; &quot;E=E&quot; &quot;F=F&quot; ## ## $main ## [1] &quot;A=BCE=DEF&quot; &quot;B=ACE=CDF&quot; &quot;C=ABE=BDF&quot; &quot;D=AEF=BCF&quot; &quot;E=ABC=ADF&quot; &quot;F=ADE=BCD&quot; ## ## $fi2 ## [1] &quot;AB=CE&quot; &quot;AC=BE&quot; &quot;AD=EF&quot; &quot;AE=BC=DF&quot; &quot;AF=DE&quot; &quot;BD=CF&quot; &quot;BF=CD&quot; ## ## $fi3 ## [1] &quot;ABD=ACF=BEF=CDE&quot; &quot;ABF=ACD=BDE=CEF&quot; By default, FrF2 chooses the fraction defined by each generator being equal to +1. knitr::kable(ff.2.6.2, align = &quot;r&quot;, caption = &quot;Treatments from a $2^{6-2}$ fractional factorial design.&quot;) Table 6.4: Treatments from a \\(2^{6-2}\\) fractional factorial design. A B C D E F -1 -1 -1 -1 -1 -1 1 -1 -1 -1 1 -1 -1 1 -1 -1 1 1 1 1 -1 -1 -1 1 -1 -1 1 -1 1 1 1 -1 1 -1 -1 1 -1 1 1 -1 -1 -1 1 1 1 -1 1 -1 -1 -1 -1 1 -1 1 1 -1 -1 1 1 1 -1 1 -1 1 1 -1 1 1 -1 1 -1 -1 -1 -1 1 1 1 -1 1 -1 1 1 -1 -1 -1 1 1 1 -1 1 1 1 1 1 1 1 6.3 Resolution and aberration Clearly, the numbers of factors involved in the effects in the defining relation play an important role in the properties of the design. Definition 6.4 Each factorial effect is commonly referred to as a word, and the number of factors involved in a factorial effect is its length. For example, word \\(ABCD\\) has length 4; word \\(BDE\\) has length 3. Definition 6.5 The resolution of a \\(2^{f-q}\\) design is the length of the shortest word in the defining relation. A design having resolution \\(R\\) implies that no effect involving \\(x\\) factors is aliased with effects involving less than \\(R-x\\) factors. Designs of the following resolution are particularly common. Resolution III: shortest word of length 3. No main effect is aliased with any other main effect; at least one main effect of aliased with a two-factor interaction. Resolution IV: shortest word of length 4. No main effect is aliased with any other main effect or any two-factor interaction; at least one pair of two-factor interactions are aliased together. Resolution V: shortest word of length 5. No main effect or two-factor interaction is aliased with any other main effect or two-factor interaction. For example, \\(2^{6-2}\\), \\(I = ABCD = CDEF = ABEF\\): resolution IV. \\(2^{3-1}\\), \\(I = ABC\\): resolution III. Definition 6.6 The word length pattern of a \\(2^{f-q}\\) design is given by \\[ W = (w_3, w_4, \\ldots, w_f)\\,, \\] where \\(w_i\\) is the number of words of length \\(i\\) in the defining relation. For example, \\(d_1\\): \\(2^{7-2}\\), \\(I = ABCF = ADEG = BCDEFG\\) \\(d_2\\): \\(2^{7-2}\\), \\(I = DEFG = ABCDF = ABCEG\\) are both resolution IV designs, but have different word length patterns \\(W(d_1) = (0, 2, 0, 1, 0)\\) \\(W(d_2) = (0, 1, 2, 0, 0)\\). Definition 6.7 For two \\(2^{f-q}\\) designs, say \\(d^\\star\\) and \\(d^\\dagger\\), let \\(r\\) be the smallest integer such that \\(w_r(d^\\star) \\ne w_r(d^\\dagger)\\). Then design \\(d^\\star\\) is said to have less aberration than design \\(d^\\dagger\\) if \\[ w_r(d^\\star) &lt; w_r(d^\\dagger)\\,. \\] If no design has less aberration than \\(d^\\star\\), then \\(d^\\star\\) has minimum aberration. Consider again designs \\(d_1\\) and \\(d_2\\) from above (\\(2^{7-2}\\) fractions). Here, \\[ \\begin{array}{ccccccc} w_3(d_1) &amp; = &amp; 0 &amp; = &amp; w_3(d_2) &amp; = &amp; 0 \\\\ w_4(d_1) &amp; = &amp; 2 &amp; &gt; &amp; w_3(d_1) &amp; = &amp; 1 \\,, \\\\ \\end{array} \\] and hence \\(d_2\\) has less aberration than \\(d_1\\). In fact, \\(d_2\\) has minimum aberration. We can use FrF2 to find designs of a specific resolution using the resolution argument (and leaving nruns and generators unspecified). The resulting design will have the minimum number of runs required to obtain the requested resolution. ff.2.6.2.r &lt;- FrF2::FrF2(nfactors = 6, resolution = 4, randomize = F, alias.info = 3) design.info(ff.2.6.2.r)$aliased ## $legend ## [1] &quot;A=A&quot; &quot;B=B&quot; &quot;C=C&quot; &quot;D=D&quot; &quot;E=E&quot; &quot;F=F&quot; ## ## $main ## [1] &quot;A=BCE=BDF&quot; &quot;B=ACE=ADF&quot; &quot;C=ABE=DEF&quot; &quot;D=ABF=CEF&quot; &quot;E=ABC=CDF&quot; &quot;F=ABD=CDE&quot; ## ## $fi2 ## [1] &quot;AB=CE=DF&quot; &quot;AC=BE&quot; &quot;AD=BF&quot; &quot;AE=BC&quot; &quot;AF=BD&quot; &quot;CD=EF&quot; &quot;CF=DE&quot; ## ## $fi3 ## [1] &quot;ACD=AEF=BCF=BDE&quot; &quot;ACF=ADE=BCD=BEF&quot; When generators and resolution are not specified, FrF2 function selects designs from catalogues of good designs, most of which have minimum aberration. ff.2.6.2.a &lt;- FrF2::FrF2(nfactors = 6, nruns = 16, randomize = F, alias.info = 3) design.info(ff.2.6.2.a)$aliased ## $legend ## [1] &quot;A=A&quot; &quot;B=B&quot; &quot;C=C&quot; &quot;D=D&quot; &quot;E=E&quot; &quot;F=F&quot; ## ## $main ## [1] &quot;A=BCE=BDF&quot; &quot;B=ACE=ADF&quot; &quot;C=ABE=DEF&quot; &quot;D=ABF=CEF&quot; &quot;E=ABC=CDF&quot; &quot;F=ABD=CDE&quot; ## ## $fi2 ## [1] &quot;AB=CE=DF&quot; &quot;AC=BE&quot; &quot;AD=BF&quot; &quot;AE=BC&quot; &quot;AF=BD&quot; &quot;CD=EF&quot; &quot;CF=DE&quot; ## ## $fi3 ## [1] &quot;ACD=AEF=BCF=BDE&quot; &quot;ACF=ADE=BCD=BEF&quot; 6.4 Analysis of fractional factorial designs The analysis can proceed as for full factorial designs (Chapter 4). Assuming only one factorial effect in each alias string is non-zero, we can estimate \\(2^{f-q}-1\\) factorial effects (one from each string) either by fitting the unit-treatment model or the corresponding regression model. For Example 6.1, we can use the unit-treatment model and contrasts to estimate all main effects and selected two-factor interactions, assuming all other factorial effects are zero. spring$treatment &lt;- factor(1:16) spring.ut &lt;- lm(height ~ treatment, data = spring) fac.contrasts.emmc &lt;- function(nlevs) { spring.num &lt;- apply(spring[, c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;)], 2, fac_to_numeric) data.frame(model.matrix(~ . + A:B + A:C + A:D + A:E + B:C + B:D + B:E, data.frame(spring.num))[, -1] / 8) } spring.emm &lt;- emmeans::emmeans(spring.ut, ~ treatment) emmeans::contrast(spring.emm, &#39;fac.contrasts&#39;) ## contrast estimate SE df t.ratio p.value ## A -0.2612 NaN 0 NaN NaN ## B 0.2213 NaN 0 NaN NaN ## C 0.1762 NaN 0 NaN NaN ## D 0.0288 NaN 0 NaN NaN ## E 0.1037 NaN 0 NaN NaN ## A.B 0.0838 NaN 0 NaN NaN ## A.C -0.1663 NaN 0 NaN NaN ## A.D 0.0563 NaN 0 NaN NaN ## A.E 0.0262 NaN 0 NaN NaN ## B.C 0.0163 NaN 0 NaN NaN ## B.D 0.0187 NaN 0 NaN NaN ## B.E -0.0362 NaN 0 NaN NaN When looking at this output, we must remember the aliasing scheme and recognise that we can only estimate these effects if all of their alaises are zero. Otherwise, each of these factorial effects is biased and not estimable (we are actually estimating the linear combination of all the aliased effects). Alternatively, we can fit the regression model directly in the contrasts; lm automatically recognises which pairs of effects are aliased, and chooses the lexicographically first effect to include in the model. spring.lm &lt;- lm(height ~ (A + B + C + D + E) ^ 5, data = spring) c(na.omit(2 * coef(spring.lm)[-1])) ## A1 B1 C1 D1 E1 A1:B1 A1:C1 A1:D1 ## -0.26125 0.22125 0.17625 0.02875 0.10375 0.08375 -0.16625 0.05625 ## A1:E1 B1:C1 B1:D1 B1:E1 A1:B1:C1 A1:B1:D1 A1:B1:E1 ## 0.02625 0.01625 0.01875 -0.03625 0.00875 -0.03875 -0.04875 In this experiment, there are three alias string that only include three-factor interactions. We may wish to use these three degrees of freedom to estimate \\(\\sigma^2\\), under the assumption that all six interactions involved in these three strings are zero. spring.lm &lt;- lm(height ~ (A + B + C + D + E) ^ 2, data = spring) anova(spring.lm) ## Analysis of Variance Table ## ## Response: height ## Df Sum Sq Mean Sq F value Pr(&gt;F) ## A 1 0.273006 0.273006 51.7752 0.005532 ** ## B 1 0.195806 0.195806 37.1343 0.008876 ** ## C 1 0.124256 0.124256 23.5650 0.016688 * ## D 1 0.003306 0.003306 0.6270 0.486284 ## E 1 0.043056 0.043056 8.1655 0.064707 . ## A:B 1 0.028056 0.028056 5.3208 0.104347 ## A:C 1 0.110556 0.110556 20.9668 0.019553 * ## A:D 1 0.012656 0.012656 2.4002 0.219085 ## A:E 1 0.002756 0.002756 0.5227 0.521953 ## B:C 1 0.001056 0.001056 0.2003 0.684809 ## B:D 1 0.001406 0.001406 0.2667 0.641213 ## B:E 1 0.005256 0.005256 0.9968 0.391657 ## Residuals 3 0.015819 0.005273 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 6.5 Blocking fractional fractorial designs We block fractional factorial designs using the same approach as Chapter 5. To block a \\(2^{f-q}\\) design into \\(b = 2^m\\) blocks, we choose \\(m\\) factorial effects to confound with blocks, also confounding all products of these \\(m\\) effects. However, we of course also confound the \\(2^q-1\\) aliases of each of these \\(2^m-1\\) effects. Hence, we actually choose to confound \\(2^m-1\\) strings of factorial effects with blocks. We must pay particular attention to make sure we do not accidentically confound a lower-order effect through the aliasing scheme. We can also use FrF2 to find blocked factorial designs. Example 6.3 Consider a \\(2^{6-2}\\) design with defining relation \\[ I = ABCE = ABDF = CDEF\\,. \\] To split this design into \\(b=2^2 = 4\\) blocks of size \\(k=4\\), we choose \\(m=2\\) defining blocks, and also confound their product. \\[ \\begin{array}{ccc} \\mathrm{Block}_1 &amp; = &amp; ACD \\\\ \\mathrm{Block}_2 &amp; = &amp; BCD \\\\ \\mathrm{Block}_1\\mathrm{Block}_2 &amp; = &amp; AB\\,. \\end{array} \\] We also confound all aliases of these effects: \\[ \\begin{array}{ccccccccc} \\mathrm{Block}_1 &amp; = &amp; ACD &amp; = &amp; BDE &amp; = &amp; BCF &amp; = &amp; ADEF \\\\ \\mathrm{Block}_2 &amp; = &amp; BCD &amp; = &amp; ADE &amp; = &amp; ACF &amp; = &amp; BEF \\\\ \\mathrm{Block}_1\\mathrm{Block}_2 &amp; = &amp; AB &amp; = &amp; CE &amp; = &amp; DF &amp; = &amp; ABCDEF \\,. \\end{array} \\] We can also find this design using FrF2, combining the arguments generators and blocks. ff.2.6.2.b.4 &lt;- FrF2::FrF2(nruns = 16, nfactors = 6, generators = c(&quot;ABC&quot;, &quot;ABD&quot;), blocks = c(&quot;ACD&quot;, &quot;BCD&quot;), randomize = F, alias.block.2fis = T, alias.info = 3) design.info(ff.2.6.2.b.4)$aliased ## $legend ## [1] &quot;A=A&quot; &quot;B=B&quot; &quot;C=C&quot; &quot;D=D&quot; &quot;E=E&quot; &quot;F=F&quot; ## ## $main ## [1] &quot;A=BCE=BDF&quot; &quot;B=ACE=ADF&quot; &quot;C=ABE=DEF&quot; &quot;D=ABF=CEF&quot; &quot;E=ABC=CDF&quot; &quot;F=ABD=CDE&quot; ## ## $fi2 ## [1] &quot;AC=BE&quot; &quot;AD=BF&quot; &quot;AE=BC&quot; &quot;AF=BD&quot; &quot;CD=EF&quot; &quot;CF=DE&quot; ## ## $fi3 ## character(0) design.info(ff.2.6.2.b.4)$aliased.with.blocks ## [1] &quot;AB&quot; &quot;CE&quot; &quot;DF&quot; &quot;ACD&quot; &quot;ACF&quot; &quot;ADE&quot; &quot;AEF&quot; &quot;BCD&quot; &quot;BCF&quot; &quot;BDE&quot; &quot;BEF&quot; One block of this design can be found by finding all the treatment combinations that satisfy, for example, \\[ ABCE = +1, ABDF = +1, ACD = -1, BCD = -1\\,. \\] Fixing values for \\(ABCE\\) and \\(ABDF\\), the other blocks are formed from the other 3 combinations of each of \\(ACD\\) and \\(BCD\\) being equal to \\(\\pm 1\\). We can also use FrF2. block12 &lt;- ff.2.6.2.b.4[1:8, ] block34 &lt;- ff.2.6.2.b.4[9:16, ] knitr::kable(cbind(block12, block34), caption = &quot;Fractional factorial $2^{6-2}$ design in $b=4$ blocks of size $k=4$.&quot;, align = &quot;r&quot;) Table 6.5: Fractional factorial \\(2^{6-2}\\) design in \\(b=4\\) blocks of size \\(k=4\\). Blocks A B C D E F Blocks A B C D E F 1 -1 -1 -1 -1 -1 -1 3 -1 1 -1 1 1 -1 1 -1 -1 1 1 1 1 3 -1 1 1 -1 -1 1 1 1 1 -1 1 -1 1 3 1 -1 -1 -1 1 1 1 1 1 1 -1 1 -1 3 1 -1 1 1 -1 -1 2 -1 1 -1 -1 1 1 4 -1 -1 -1 1 -1 1 2 -1 1 1 1 -1 -1 4 -1 -1 1 -1 1 -1 2 1 -1 -1 1 1 -1 4 1 1 -1 -1 -1 -1 2 1 -1 1 -1 -1 1 4 1 1 1 1 1 1 Analysis proceeds as before, except no factorial effect can be estimated that is within an alias string that is confounded with blocks. For Example, split the spring experiment from Exa,ple 6.1 into \\(b=2\\) blocks of size \\(k=8\\) using confounding the alias string \\(ABE = ACD\\) with blocks. spring.blocks &lt;- spring spring.blocks$blocks &lt;- with(data.frame(spring), fac_to_numeric(A) * fac_to_numeric(B) * fac_to_numeric(C)) springb.lm &lt;- lm(height ~ blocks + (A + B + C + D + E) ^ 3, data = spring.blocks) anova(springb.lm) ## Analysis of Variance Table ## ## Response: height ## Df Sum Sq Mean Sq F value Pr(&gt;F) ## blocks 1 0.000306 0.000306 NaN NaN ## A 1 0.273006 0.273006 NaN NaN ## B 1 0.195806 0.195806 NaN NaN ## C 1 0.124256 0.124256 NaN NaN ## D 1 0.003306 0.003306 NaN NaN ## E 1 0.043056 0.043056 NaN NaN ## A:B 1 0.028056 0.028056 NaN NaN ## A:C 1 0.110556 0.110556 NaN NaN ## A:D 1 0.012656 0.012656 NaN NaN ## A:E 1 0.002756 0.002756 NaN NaN ## B:C 1 0.001056 0.001056 NaN NaN ## B:D 1 0.001406 0.001406 NaN NaN ## B:E 1 0.005256 0.005256 NaN NaN ## A:B:D 1 0.006006 0.006006 NaN NaN ## A:B:E 1 0.009506 0.009506 NaN NaN ## Residuals 0 0.000000 NaN 6.6 Exercises A \\(2^{5-2}\\) design has generators \\(ACD\\) and \\(BCE\\). Write down the full defining relation. What resolution is this design? After analysis, factor \\(E\\) turns out to be unimportant. By assuming that all effects involving factor \\(E\\) and all three-factor and higher-order interactions are negligible, determine which two-factor interactions can be estimated together with the four main effects of factors \\(A\\), \\(B\\), \\(C\\) and \\(D\\). Consider the following two fractional factorial designs. A \\(2^{6-2}\\) design with generators \\(ABCDE\\) and \\(ABDF\\). A \\(2^{6-2}\\) design with generators \\(ABCE\\) and \\(ABDF\\). What is the resolution of each design? Which design would be preferred under the criterion of minimum aberration? For design (ii), if we know that any two-factor interaction involving factor \\(F\\) is negligible, which other two-factor interactions can be estimated under the assumption that three-factor and higher-order interactions are also negligible? References "]]
