[["blocking.html", "Chapter 3 Blocking 3.1 Unit-block-treatment model", " Chapter 3 Blocking The completely randomised design (CRD) works well when there is sufficient homogeneous experimental units to perform the whole experiment under the same, or very similar, conditions and there are no restrictions on the randomisation of treatments to units. The only systematic (non-random) differences in the observed responses result from differences between the treatments. While such designs are commonly and successfully used, especially in smaller experiments, their application can often be unrealistic or impractical in many settings. A common way in which the CRD fails is a lack of sufficiently similar experimental units. If there are systemtic differences between different batches, or blocks of units, these differences should be taken into account in both the allocation of treatments to units and the modelling of the resultant data. Otherwise, block-to-block differences may bias treatment comparisons and/or inflate our estimate of the background variability and hence reduce our ability to detect important treatment effects. Example 3.1 Steel bar experiment (Morris, 2011, ch. 4) Kocaoz et al. (2005) described an experiment to assess the strength of steel reinforcement bars from \\(t=4\\) coatings1 (treatments). In total \\(n=32\\) different bars (units) were available, but the testing process meant sets of four bars were tested together. To account for potential test-specific features (e.g. environmental or operational), these different test sets were assumed to form \\(b=8\\) blocks of size \\(k=4\\). The data are shown in Table 3.1 below. bar &lt;- data.frame(coating = rep(factor(1:4), 8), block = rep(factor(1:8), rep(4, 8)), strength = c(136, 147, 138, 149, 136, 143, 122, 153, 150, 142, 131, 136, 155, 148, 130, 129, 145, 149, 136, 139, 150, 149, 147, 144, 147, 150, 125, 140, 148, 149, 118, 145) ) knitr::kable( tidyr::pivot_wider(bar, names_from = coating, values_from = strength), col.names = c(&quot;Block&quot;, paste(&quot;Coating&quot;, 1:4)), caption = &quot;Steel bar experiment: tensile strength values (kliograms per square inch, ksi) from steel bars with four different coatings.&quot; ) Table 3.1: Steel bar experiment: tensile strength values (kliograms per square inch, ksi) from steel bars with four different coatings. Block Coating 1 Coating 2 Coating 3 Coating 4 1 136 147 138 149 2 136 143 122 153 3 150 142 131 136 4 155 148 130 129 5 145 149 136 139 6 150 149 147 144 7 147 150 125 140 8 148 149 118 145 Here, each block has size 4, which is equal to the number of treatments in the experiment, and each treatment is applied in each block. This is an example of a randomised complete block design. We can study the data graphically, plotting by treatment and by block. boxplot(strength ~ block, data = bar) boxplot(strength ~ coating, data = bar) Figure 3.1: Steel bar experiment: distributions of tensile strength (ksi) from the eight blocks (top) and the four coatings (bottom). The box plots within each plot in Figure 3.1 are comparable, as every treatment has occured with every block the same number of times (once). For example, when we compare the box plots for treatments 1 and 3, we know each of then display one observation from each block. Therefore, differences between treatments will not be influenced by large differences between blocks. This balance makes our analysis more straighforward. By eye, it appears here there may be differences between both coating 3 and the other three coatings. Example 3.2 Tyre experiment (Wu and Hamada, 2009, ch. 3) Davies (1954), p.200, examined the effect of \\(t=4\\) different rubber compounds (treatments) on the lifetime of a tyre. Each tyre is only large enough to split into \\(k=3\\) segments whilst still containing a representative amount of each compound. When tested, each tyre is subjected to the same road conditions, and hence is treated as a block. A design with \\(b=4\\) blocks was used, as displayed in Table 3.2. tyre &lt;- data.frame(compound = as.factor(c(1, 2, 3, 1, 2, 4, 1, 3, 4, 2, 3, 4)), block = rep(factor(1:4), rep(3, 4)), wear = c(238, 238, 279, 196, 213, 308, 254, 334, 367, 312, 421, 412) ) options(knitr.kable.NA = &#39;&#39;) knitr::kable( tidyr::pivot_wider(tyre, names_from = compound, values_from = wear), col.names = c(&quot;Block&quot;, paste(&quot;Compound&quot;, 1:4)), caption = &quot;Tyre experiment: wear measurements from tires made with four different rubber compounds.&quot; ) Table 3.2: Tyre experiment: wear measurements from tires made with four different rubber compounds. Block Compound 1 Compound 2 Compound 3 Compound 4 1 238 238 279 2 196 213 308 3 254 334 367 4 312 421 412 Here, each block has size \\(k=3\\), which is smaller than the number of treatments (\\(t=4\\)). Hence, each block cannot contain an application of each treatment. This is an example of an incomplete block design. Graphical exploration of the data is a little more problematic in this example. As each treatment does not occur in each block, box plots such as Figure 3.2 are not as informative. Do compounds three and four have higher average wear because they were the only compounds to both occur in blocks 3 and 4? Or do blocks 3 and 4 have a higher mean because they contain both compounds 3 and 4? The design cannot help us entirely disentangle the impact of blocks and treatments2. In our modelling, we will assume variation should first be described by blocks (which are generally fixed aspects of the experiment) and then treatments (which are more directly under the experimenter’s control). boxplot(wear ~ block, data = tyre) boxplot(wear ~ compound, data = tyre) Figure 3.2: Tyre experiment: distributions of wear from the four blocks (top) and the four compounds (bottom). 3.1 Unit-block-treatment model If \\(n_{ij}\\) is the number of times treatment \\(j\\) occurs in block \\(i\\), a common statistical model to describe data from a blocked experiment has the form \\[\\begin{equation} y_{ijl} = \\mu + \\beta_i + \\tau_i + \\varepsilon_{ijl}\\,, \\qquad i = 1,\\ldots, b; j = 1, \\ldots, t; l = 1,\\ldots,n_{ij}\\,, \\tag{3.1} \\end{equation}\\] where \\(y_{ijl}\\) is the response from the \\(l\\)th application of the \\(j\\)th treatment in the \\(i\\)th block, \\(\\mu\\) is a constant parameter, \\(\\beta_i\\) is the effect of the \\(i\\)th block, \\(\\tau_j\\) is the effect of treatment \\(j\\), and \\(\\varepsilon_{ijl}\\sim N(0, \\sigma^2)\\) are once again random individual effects from each experimental unit, assumed independent. The total number of runs in the experiment is given by \\(n = \\sum_{i=1}^b\\sum_{j=1}^t n_{ij}\\). For Example 3.1, there are \\(t=4\\) experiments, \\(b = 8\\) blocks and each treatment occurs once in each block, so \\(n_{ij} = 1\\) for all \\(i, j\\). In Example 3.2, there are again \\(t=4\\) treatments but now only \\(b=4\\) blocks and not every treatment occurs in every block. In fact, we have \\(n_{11} = n_{12} = n_{13} = 1\\), \\(n_{14} = 0\\), \\(n_{21} = n_{22} =n_{24} = 1\\), \\(n_{23} = 0\\), \\(n_{31} = n_{33} =n_{34} = 1\\), \\(n_{32} = 0\\), \\(n_{41} = 0\\) and \\(n_{42} = n_{43} =n_{44} = 1\\). References "]]
